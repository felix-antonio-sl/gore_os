_meta:
  urn: urn:goreos:entity:d_fin:ENT-FIN-RENDICIONES_RENDICION:1.0.0
  type: Entity
  schema: urn:goreos:schema:entity:1.0.0
category: Master
is_abstract: false
attributes:
- name: id_rendicion
  type: String
  key: true
- name: transferencia_id
  type: String
  fk: ENT-FIN-TRANSFERENCIA
  nullable: false
- name: convenio_id
  type: String
  fk: ENT-FIN-CONVENIO
  nullable: false
- name: ejecutor_id
  type: String
  fk: ENT-FIN-ACTOR_IPR
  nullable: false
- name: ejecutor_rut
  type: String
  nullable: false
- name: tipo
  type: Enum[Parcial, Final, Complementaria]
  nullable: false
- name: numero_rendicion
  type: Integer
  default: 1
  description: Secuencial dentro del convenio
- name: periodo_desde
  type: Date
  nullable: false
- name: periodo_hasta
  type: Date
  nullable: false
- name: monto_rendido
  type: Decimal
  nullable: false
  description: Total presentado por el ejecutor
- name: monto_observado
  type: Decimal
  default: 0
  description: Monto con reparos
- name: monto_aprobado
  type: Decimal
  computed: true
  formula: monto_rendido - monto_observado
- name: saldo_por_rendir
  type: Decimal
  computed: true
  description: Calculado contra monto total transferido
- name: fecha_presentacion
  type: Date
  nullable: false
- name: fecha_ingreso_sistema
  type: DateTime
  nullable: true
  description: Timestamp de carga en GORE_OS
- name: fecha_revision
  type: Date
  nullable: true
- name: fecha_aprobacion
  type: Date
  nullable: true
- name: plazo_legal_dias
  type: Integer
  default: 30
  description: Plazo para revisar según Res. 30/2015
- name: dias_en_revision
  type: Integer
  computed: true
  formula: DATEDIFF(CURRENT_DATE, fecha_presentacion)
- name: fuera_de_plazo
  type: Boolean
  computed: true
  formula: dias_en_revision > plazo_legal_dias AND estado = 'EnRevision'
- name: revisor_id
  type: String
  fk: ROL-ANALISTA-RENDICIONES
  nullable: true
- name: supervisor_id
  type: String
  fk: ROL-JEFE-UCR
  nullable: true
- name: estado
  type: Enum[Borrador, Presentada, EnRevision, Observada, Aprobada, Rechazada, Reintegro]
  default: Borrador
- name: cantidad_observaciones
  type: Integer
  default: 0
- name: ubicacion_fisica
  type: String
  nullable: true
  description: Archivador/Carpeta/Caja
- name: codigo_qr
  type: String
  nullable: true
  description: QR para ubicación rápida
- name: coherencia_sigfe
  type: Boolean
  default: false
  description: Cuadra con registros SIGFE
- name: folio_sigfe
  type: String
  nullable: true
invariants:
- id: INV-REND-001
  name: monto_no_excede_transferencia
  rule: monto_rendido <= transferencia.monto_transferido
  description: No se puede rendir más de lo transferido
- id: INV-REND-002
  name: periodo_coherente
  rule: periodo_hasta >= periodo_desde
  description: El período debe ser cronológicamente válido
- id: INV-REND-003
  name: aprobacion_requiere_revision
  rule: estado = 'Aprobada' → fecha_revision IS NOT NULL
  description: No puede aprobarse sin haberse revisado
- id: INV-REND-004
  name: observada_tiene_observaciones
  rule: estado = 'Observada' → cantidad_observaciones > 0
  description: Estado observada requiere al menos una observación
id: ENT-FIN-RENDICIONES_RENDICION
urn: urn:goreos:entity:d_fin:ENT-FIN-RENDICIONES_RENDICION:1.0.0
name: Rendiciones Rendicion
domain: D-FIN
