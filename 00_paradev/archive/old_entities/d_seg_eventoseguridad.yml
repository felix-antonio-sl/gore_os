_meta:
  urn: urn:goreos:entity:d_seg:ENT-SEG-EVENTOSEGURIDAD:1.0.0
  type: Entity
  schema: urn:goreos:schema:entity:1.0.0
category: Master
is_abstract: false
attributes:
- name: id_evento
  type: String
  key: true
  description: UUID del evento o log ID
- name: timestamp
  type: Timestamp
  nullable: false
  description: Fecha/Hora exacta del evento (UTC)
- name: fuente
  type: String
  nullable: false
  description: Sistema origen (Firewall, AD, App, Antivirus)
- name: tipo_evento
  type: Enum[Autenticacion, AccesoRecurso, ModificacionConfiguracion, TraficoRed,
    Malware, ErrorSistema, Otro]
  nullable: false
- name: severidad
  type: Enum[Info, Low, Medium, High, Critical]
  default: Info
- name: mensaje
  type: Text
  nullable: false
  description: Contenido raw o parseado del log
- name: activo_relacionado_id
  type: String
  fk: ENT-SEG-ACTIVO-INFORMACION
  nullable: true
- name: usuario_involucrado_id
  type: String
  fk: ENT-BACK-FUNCIONARIO
  nullable: true
  description: Si el evento tiene identidad asociada
- name: ip_origen
  type: String
  nullable: true
- name: ip_destino
  type: String
  nullable: true
- name: es_incidente
  type: Boolean
  default: false
  description: ¿Escaló a incidente?
- name: incidente_id
  type: String
  fk: ENT-SEG-INCIDENTE
  nullable: true
  description: Link al incidente generado
invariants:
- id: INV-EVT-001
  name: incidente_link
  rule: es_incidente = TRUE → incidente_id IS NOT NULL
  description: Si es marcado como incidente, debe enlazar al ID
id: ENT-SEG-EVENTOSEGURIDAD
urn: urn:goreos:entity:d_seg:ENT-SEG-EVENTOSEGURIDAD:1.0.0
name: Eventoseguridad
domain: D-SEG
