_meta:
  urn: urn:goreos:entity:d_seg:ENT-SEG-CONTROLSEGURIDAD:1.0.0
  type: Entity
  schema: urn:goreos:schema:entity:1.0.0
category: Master
is_abstract: false
attributes:
- name: id_control
  type: String
  key: true
  description: 'ID interno o estándar (ej: ISO-A.5.1)'
- name: nombre
  type: String
  nullable: false
- name: descripcion
  type: Text
  nullable: true
- name: tipo_control
  type: Enum[Preventivo, Detectivo, Correctivo, Disuasivo, Recuperacion]
  nullable: false
- name: categoria_iso
  type: Enum[Organizacional, Personas, Fisico, Tecnologico]
  nullable: true
  description: Dominios ISO 27002:2022
- name: referencia_normativa
  type: Array[String]
  nullable: true
  description: 'Referencias (ej: ISO 27001:A.5.1, ENS:OP.pl.1)'
- name: estado_implementacion
  type: Enum[NoIniciado, EnDiseno, EnImplementacion, Operativo, Ineficaz]
  default: NoIniciado
- name: implementacion_detalles
  type: Text
  nullable: true
  description: Cómo se implementa técnicamente
- name: responsable_implementacion_id
  type: String
  fk: ENT-BACK-FUNCIONARIO
  nullable: true
- name: eficacia_evaluada
  type: Enum[NoEvaluada, Baja, Media, Alta]
  default: NoEvaluada
- name: fecha_ultima_prueba
  type: Date
  nullable: true
  description: Fecha último test/auditoría del control
- name: costo_implementacion
  type: Decimal
  nullable: true
- name: costo_recurrente
  type: Decimal
  nullable: true
invariants:
- id: INV-SEG-CRL-001
  name: operativo_requiere_responsable
  rule: estado_implementacion = 'Operativo' → responsable_implementacion_id IS NOT
    NULL
  description: Control operativo debe tener responsable asignado
id: ENT-SEG-CONTROLSEGURIDAD
urn: urn:goreos:entity:d_seg:ENT-SEG-CONTROLSEGURIDAD:1.0.0
name: Controlseguridad
domain: D-SEG
