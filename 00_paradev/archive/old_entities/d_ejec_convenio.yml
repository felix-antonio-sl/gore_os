_meta:
  urn: urn:goreos:entity:d_ejec:ENT-EJEC-CONVENIO:1.0.0
  type: Entity
  schema: urn:goreos:schema:entity:1.0.0
category: Master
is_abstract: false
attributes:
- name: id_convenio
  type: String
  key: true
  description: Identificador único (ej. CONV-2024-001)
- name: numero_decreto
  type: String
  nullable: true
  description: Número del decreto aprobatorio
- name: ipr_id
  type: String
  fk: ENT-FIN-IPR
  nullable: false
  description: IPR que financia este convenio
- name: cdp_id
  type: String
  fk: ENT-FIN-CDP
  nullable: false
  description: Certificado de Disponibilidad Presupuestaria
- name: tipo_convenio
  type: Enum[Mandato, Transferencia, Colaboracion, Marco, Programacion]
  nullable: false
  description: Tipo según domain_d-ejec.md
- name: titulo
  type: String
  nullable: false
  description: Nombre del convenio
- name: objeto
  type: Text
  nullable: false
  description: Descripción del objeto del convenio
- name: ejecutor_id
  type: String
  fk: ENT-EJEC-EJECUTOR
  nullable: false
  description: Entidad que ejecuta
- name: ejecutor_tipo
  type: Enum[Municipalidad, ServicioPublico, Universidad, Fundacion, Corporacion,
    Empresa, ONG, Otro]
  nullable: false
  description: Tipo de ejecutor
- name: monto_total
  type: Decimal
  nullable: false
  description: Monto total del convenio
- name: monto_gore
  type: Decimal
  nullable: false
  description: Aporte del GORE
- name: monto_contraparte
  type: Decimal
  default: 0
  description: Aporte del ejecutor u otro
- name: fecha_firma
  type: Date
  nullable: true
  description: Fecha de firma
- name: fecha_inicio_vigencia
  type: Date
  nullable: true
  description: Fecha inicio de vigencia
- name: fecha_termino_vigencia
  type: Date
  nullable: true
  description: Fecha término original
- name: plazo_ejecucion_meses
  type: Integer
  nullable: true
  description: Plazo de ejecución en meses
- name: estado
  type: Enum[Borrador, EnRevisionJuridica, ParaFirma, Vigente, ProrrogaSolicitada,
    AddendumEnProceso, Terminado, Liquidado, Caducado]
  default: Borrador
  description: Estado del convenio según domain_d-ejec.md
- name: monto_transferido
  type: Decimal
  default: 0
  description: Total transferido a la fecha
- name: monto_rendido
  type: Decimal
  default: 0
  description: Total rendido y aprobado
- name: avance_fisico_pct
  type: Decimal
  default: 0
  description: Avance físico porcentual
- name: cantidad_ep_aprobados
  type: Integer
  default: 0
  description: Estados de pago aprobados
invariants:
- id: INV-CONV-001
  name: suma_aportes
  rule: monto_gore + monto_contraparte = monto_total
  description: La suma de aportes debe igualar el total
  severity: error
- id: INV-CONV-002
  name: vigencia_coherente
  rule: fecha_termino_vigencia >= fecha_inicio_vigencia
  description: Fechas de vigencia coherentes
  severity: error
- id: INV-CONV-003
  name: cdp_requerido
  rule: '(estado IN (''Vigente'', ''Terminado'', ''Liquidado'')) → (cdp_id IS NOT
    NULL)

    '
  description: Convenios activos requieren CDP
  severity: error
id: ENT-EJEC-CONVENIO
urn: urn:goreos:entity:d_ejec:ENT-EJEC-CONVENIO:1.0.0
name: Convenio
domain: D-EJEC
