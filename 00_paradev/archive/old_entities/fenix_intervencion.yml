_meta:
  urn: urn:goreos:entity:d_intervencion:ENT-INTERVENCION-FENIX_INTERVENCION:1.0.0
  type: Entity
  schema: urn:goreos:schema:entity:1.0.0
category: Master
is_abstract: false
attributes:
- name: id_intervencion
  type: String
  key: true
  description: 'Identificador único (ej: INT-2025-001)'
- name: codigo
  type: String
  nullable: false
  description: Código de intervención
- name: nivel
  type: Enum[I, II, III, IV]
  nullable: false
  description: Nivel de intervención
- name: categoria
  type: Enum[ContingenciaCritica, ProcesoEstancado, AceleracionIniciativa, MejoraInstitucional]
  nullable: false
  description: Categoría según domain_fenix.md
- name: criticidad
  type: Integer
  nullable: false
  description: Escala 1-5 (5 = máxima criticidad)
- name: estado
  type: Enum[Detectada, EnDiagnostico, Planificada, EnEjecucion, EnCierre, Cerrada,
    Cancelada]
  default: Detectada
  description: Estado del ciclo de vida
- name: objetivo
  type: Text
  nullable: false
  description: Objetivo específico y medible
- name: descripcion_situacion
  type: Text
  nullable: true
  description: Descripción de la situación a intervenir
- name: dominio_origen
  type: Enum[D-FIN, D-EJEC, D-GOB, D-NORM, D-BACK, D-TDE, D-TERR, D-GESTION, D-SEG,
    D-PLAN, Transversal]
  nullable: false
  description: Dominio donde se detectó la necesidad
- name: dominios_involucrados
  type: Array[String]
  nullable: true
  description: Dominios afectados por la intervención
- name: trigger_tipo
  type: Enum[Automatico, Manual]
  nullable: false
  description: Tipo de activación
- name: trigger_origen_id
  type: String
  nullable: true
  description: ID del trigger (H_gore, IPR, Convenio, etc.)
- name: trigger_descripcion
  type: Text
  nullable: true
  description: Descripción del evento disparador
- name: autoriza_id
  type: String
  fk: ENT-BACK-FUNCIONARIO
  nullable: false
  description: GR para Nivel I-II, AR para III-IV
- name: autoriza_rol
  type: Enum[Gobernador, AdministradorRegional]
  nullable: false
- name: fecha_autorizacion
  type: Date
  nullable: true
- name: jefe_intervencion_id
  type: String
  fk: ENT-BACK-FUNCIONARIO
  nullable: false
  description: Jefe de la fuerza de tarea
- name: fecha_deteccion
  type: Date
  nullable: false
  description: Fecha de detección
- name: fecha_inicio
  type: Date
  nullable: true
  description: Inicio de ejecución
- name: fecha_fin_planificada
  type: Date
  nullable: true
  description: Fecha objetivo de cierre
- name: fecha_cierre
  type: Date
  nullable: true
  description: Fecha real de cierre
- name: duracion_dias
  type: Integer
  computed: true
  formula: DATEDIFF(fecha_cierre, fecha_inicio)
  description: Duración real en días
- name: dentro_plazo
  type: Boolean
  computed: true
  formula: fecha_cierre <= fecha_fin_planificada
- name: indicadores_exito
  type: JSON
  nullable: true
  description: "Métricas definidas:\n[{\n  \"indicador\": \"...\",\n  \"meta\": 0,\n\
    \  \"peso\": 0.2\n}]\n"
- name: metricas_pre
  type: JSON
  nullable: true
  description: Situación antes de intervenir
- name: metricas_post
  type: JSON
  nullable: true
  description: Situación después de intervenir
- name: resultado
  type: Enum[Exitosa, Parcial, Fallida, Escalada]
  nullable: true
  description: Resultado final
- name: puntaje_exito
  type: Decimal
  nullable: true
  description: Puntaje calculado (0-100)
- name: notificado_core
  type: Boolean
  default: false
  description: Notificar Comisión de Control CORE para Nivel I-II
- name: fecha_notificacion_core
  type: Date
  nullable: true
- name: informe_cierre_url
  type: String
  nullable: true
  description: URL del informe final
- name: observaciones_cierre
  type: Text
  nullable: true
- name: decreto_aprobacion_id
  type: String
  nullable: true
  description: ID decreto GR para Nivel I (obligatorio según LOC 19.175)
- name: costo_total_estimado
  type: Decimal
  computed: true
  formula: SUM(RecursoIntervencion.costo_estimado)
  description: Costo total estimado (suma de RecursoIntervencion)
- name: costo_total_real
  type: Decimal
  computed: true
  formula: SUM(RecursoIntervencion.costo_real)
  description: Costo total real incurrido
invariants:
- id: INV-INT-001
  name: nivel_12_requiere_gr
  rule: nivel IN ('I', 'II') → autoriza_rol = 'Gobernador'
  description: Niveles I y II requieren autorización del Gobernador
  severity: error
- id: INV-INT-002
  name: cerrada_requiere_resultado
  rule: estado = 'Cerrada' → resultado IS NOT NULL
  description: Intervención cerrada debe tener resultado
  severity: error
- id: INV-INT-003
  name: core_notificado_nivel_12
  rule: nivel IN ('I', 'II') AND estado = 'EnEjecucion' → notificado_core = TRUE
  description: Nivel I-II requiere notificación a CORE
  severity: warning
- id: INV-INT-004
  name: ejecucion_requiere_autorizacion
  rule: estado = 'EnEjecucion' → fecha_autorizacion IS NOT NULL
  description: Ejecución requiere autorización previa
id: ENT-INTERVENCION-FENIX_INTERVENCION
urn: urn:goreos:entity:d_intervencion:ENT-INTERVENCION-FENIX_INTERVENCION:1.0.0
name: Fenix Intervencion
domain: D-INTERVENCION
