_meta:
  urn: urn:goreos:entity:d-fin:reintegro:1.0.0
  type: Entity
  schema: urn:goreos:schema:entity:1.0.0
id: ENT-FIN-REINTEGRO
urn: urn:goreos:entity:d-fin:reintegro:1.0.0
name: Reintegro
domain: D-FIN
subdomain: rendiciones
category: Transaction
is_abstract: false
attributes:
- name: id_reintegro
  type: String
  key: true
- name: transferencia_id
  type: String
  fk: ENT-FIN-TRANSFERENCIA
  nullable: false
- name: rendicion_id
  type: String
  fk: ENT-FIN-RENDICION
  nullable: true
- name: convenio_id
  type: String
  fk: ENT-FIN-CONVENIO
  nullable: false
- name: motivo
  type: Enum[ExcedenteNoUtilizado, RechazoRendicion, InteresesBancarios, RescisionConvenio,
    CaducidadPlazo, Multa]
  nullable: false
- name: tipo_origen
  type: Enum[Administrativo, Financiero, Legal]
  nullable: true
  description: Clasificación analítica para contabilidad
- name: descripcion_motivo
  type: Text
  nullable: true
- name: monto_reintegro
  type: Decimal
  nullable: false
- name: monto_intereses
  type: Decimal
  default: 0
  description: Intereses devengados por fondos no utilizados
- name: monto_total
  type: Decimal
  computed: true
  formula: monto_reintegro + monto_intereses
- name: medio_reintegro
  type: Enum[TransferenciaBancaria, DepositoCuentaGORE, Cheque, CompensacionFutura]
  nullable: false
- name: banco_origen
  type: String
  nullable: true
- name: numero_comprobante
  type: String
  nullable: true
- name: boleta_deposito_url
  type: String
  nullable: true
  description: Escaneo del comprobante de depósito
- name: rut_pagador
  type: String
  nullable: true
  description: RUT de quien realizó la transferencia (puede diferir del ejecutor)
- name: fecha_reintegro
  type: Date
  nullable: true
- name: estado
  type: Enum[Solicitado, EnTramite, DepositoRealizado, Conciliado, Contabilizado,
    Rechazado]
  default: Solicitado
- name: estado_conciliacion
  type: Enum[Pendiente, Conciliado, Diferencia]
  default: Pendiente
  description: Estado de la conciliación bancaria en ERP
- name: cuenta_ingreso
  type: String
  nullable: true
  description: Cuenta contable de ingreso propio
- name: folio_sigfe
  type: String
  nullable: true
- name: ejecutor_id
  type: String
  fk: ENT-FIN-ACTOR_IPR
- name: ejecutor_rut
  type: String
  nullable: false
- name: fecha_solicitud
  type: Date
  nullable: false
- name: fecha_contabilizacion
  type: Date
  nullable: true
invariants:
- name: reintegro_positivo
  rule: monto_reintegro > 0
- name: origen_valido
  rule: transferencia_id NOT NULL OR convenio_id NOT NULL
