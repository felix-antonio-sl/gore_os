# ==============================================================================
# GORE_OS Entity Atom: IndicadorTerritorial (Métricas Territoriales)
# ==============================================================================
# Domain: D-TERR (Territorial Intelligence)
# Subdomain: Observatorio
# Source: KB-090, domain_d-terr.md P6, dialogo_dplan_dterr.md
# ==============================================================================

_metadata:
  version: "1.0.0"
  status: active
  created_at: "2025-12-21"
  created_by: "Arquitecto Categórico + Gobernador Virtual"
  domain: D-TERR
  subdomain: observatorio
  kb_source:
    - "kb_gn_090_gestion_informacion_geoespacial_koda.yml P6"
    - "domain_d-terr.md P6: Observatorio Regional"
    - "dialogo_dplan_dterr.md"

entity:
  id: ENT-TERR-INDICADOR
  name: IndicadorTerritorial
  name_es: Indicador Territorial
  description: |
    Métrica de realidad territorial que alimenta el Observatorio Regional.
    Proviene de fuentes externas (INE, CASEN, BCN, SINIM, DEIS-MINSAL)
    y se georreferencia a nivel comunal.

    Complementa a IndicadorERD: mientras IndicadorERD mide objetivos
    estratégicos, IndicadorTerritorial mide la realidad del territorio.

  purpose: |
    Modelar indicadores territoriales para:
    - Caracterizar comunas
    - Identificar brechas
    - Alimentar tableros públicos
    - Informar planificación basada en evidencia

  categorical_type: Object
  is_abstract: false
  category: Reference

attributes:
  - name: id_indicador
    type: String
    key: true
    description: Identificador único

  - name: nombre
    type: String
    nullable: false
    description: Nombre del indicador

  - name: descripcion
    type: Text
    nullable: true
    description: Descripción detallada

  - name: fuente
    type: Enum[INE, CASEN, BCN, SINIM, DEIS_MINSAL, ENUSC, MINEDUC, Otro]
    nullable: false
    description: Fuente oficial del dato

  - name: dimension
    type: Enum[Demografica, Economica, Social, Ambiental, Seguridad, Salud, Educacion, Infraestructura]
    nullable: false
    description: Dimensión temática

  - name: subdimension
    type: String
    nullable: true
    description: Subdimensión específica

  # Definición técnica
  - name: unidad
    type: String
    nullable: false
    description: Unidad de medida (%, N°, M$, tasa)

  - name: formula
    type: String
    nullable: true
    description: Fórmula de cálculo

  - name: tipo_calculo
    type: Enum[Directo, Promedio, Tasa, Indice, Razon]
    default: Directo
    description: Tipo de cálculo

  # Frecuencia y cobertura
  - name: frecuencia_actualizacion
    type: Enum[Mensual, Trimestral, Semestral, Anual, Bienal, Decenal]
    nullable: false
    description: Frecuencia de actualización

  - name: desagregacion
    type: Enum[Regional, Provincial, Comunal]
    nullable: false
    description: Nivel de desagregación disponible

  - name: desagregable_sexo
    type: Boolean
    default: false
    description: ¿Desagregable por sexo?

  - name: desagregable_edad
    type: Boolean
    default: false
    description: ¿Desagregable por rango etario?

  # Vinculación ERD
  - name: objetivo_erd_id
    type: String
    fk: ENT-PLAN-OE
    nullable: true
    description: Objetivo ERD relacionado (si aplica)

  # Valores de referencia
  - name: valor_regional_actual
    type: Decimal
    nullable: true
    description: Último valor a nivel regional

  - name: valor_nacional_referencia
    type: Decimal
    nullable: true
    description: Valor nacional para comparación

  - name: fecha_ultimo_valor
    type: Date
    nullable: true
    description: Fecha del último valor

  # Umbrales
  - name: umbral_critico
    type: Decimal
    nullable: true
    description: Valor que activa alerta

  - name: umbral_objetivo
    type: Decimal
    nullable: true
    description: Meta deseable

  # Publicación
  - name: publicado
    type: Boolean
    default: true
    description: ¿Visible en Observatorio público?

  - name: url_fuente
    type: String
    nullable: true
    description: URL de la fuente original

morphisms:
  mide: [ENT-TERR-COMUNA]
  alimenta: [ENT-TERR-BRECHARD]
  relacionado_con: [ENT-PLAN-OE]
  publicado_en: [Observatorio]

audit:
  fields_tracked:
    - valor_regional_actual
  retention_years: 15
