# Entidad: Vehiculo (Vehículo de Flota Institucional)
# Domain: D-BACK
# Subdomain: flota
# Generated: 2025-12-21 (Phase 20.1 Deep Modeling)

id: ENT-BACK-VEHICULO
urn: "urn:goreos:entity:d-back:vehiculo:1.0.0"
name: Vehículo
domain: D-BACK
subdomain: flota
category: Master
canonical_source:
  - "urn:knowledge:gorenuble:gn:manual-activo-fijo:1.0.0#GN-MANUAL-ACTIVO-FIJO-S08-02"

description: |
  Vehículo de la flota institucional del GORE.
  Extiende ActivoFijo con datos específicos de vehículos.

attributes:
  - name: id_vehiculo
    type: String
    key: true

  - name: activo_fijo_id
    type: String
    fk: ENT-BACK-ACTIVO_FIJO
    nullable: false
    description: Enlace al registro de activo fijo

  - name: patente
    type: String
    nullable: false
    unique: true

  - name: tipo_vehiculo
    type: Enum[Automovil, Camioneta, Furgon, Bus, Maquinaria]
    nullable: false

  - name: marca
    type: String
    nullable: false

  - name: modelo
    type: String
    nullable: false

  - name: anio_fabricacion
    type: Integer
    nullable: false

  - name: color
    type: String
    nullable: true

  - name: numero_motor
    type: String
    nullable: true

  - name: numero_chasis
    type: String
    nullable: true

  - name: capacidad_pasajeros
    type: Integer
    nullable: true

  - name: capacidad_carga_kg
    type: Decimal
    nullable: true

  # Documentos obligatorios
  - name: fecha_revision_tecnica
    type: Date
    nullable: true

  - name: fecha_vencimiento_revision
    type: Date
    nullable: true

  - name: numero_soap
    type: String
    nullable: true

  - name: fecha_vencimiento_soap
    type: Date
    nullable: true

  - name: seguro_voluntario
    type: Boolean
    default: false

  - name: poliza_seguro
    type: String
    nullable: true

  # Control operativo
  - name: kilometraje_actual
    type: Integer
    nullable: true

  - name: fecha_ultima_mantencion
    type: Date
    nullable: true

  - name: km_proxima_mantencion
    type: Integer
    nullable: true

  - name: conductor_asignado_id
    type: String
    fk: ROL-CONDUCTOR
    nullable: true

  - name: estado_disponibilidad
    type: Enum[Disponible, EnUso, EnMantencion, FueraServicio]
    default: Disponible

invariants:
  - name: revision_tecnica_vigente
    rule: "fecha_vencimiento_revision >= TODAY() for Disponible"
    source: "Normativa de tránsito"

  - name: soap_vigente
    rule: "fecha_vencimiento_soap >= TODAY() for Disponible"

morphisms:
  es_un: [ENT-BACK-ACTIVO_FIJO]
  asignado_a: [ROL-CONDUCTOR]
  genera: [ENT-BACK-BITACORA_VIAJE, ENT-BACK-SOLICITUD_VEHICULO]
