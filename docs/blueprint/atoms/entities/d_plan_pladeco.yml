# ==============================================================================
# GORE_OS Entity Atom: PLADECO (Plan de Desarrollo Comunal)
# ==============================================================================
# Domain: D-PLAN (Planificación Estratégica)
# Subdomain: Planificación Comunal
# Source: LOC GORE Art. 16 k), Ley 18.695, dialogo_cobertura_rigurosa
# ==============================================================================

_metadata:
  version: "1.0.0"
  status: active
  created_at: "2025-12-21"
  created_by: "Arquitecto Categórico + Goreólogo"
  domain: D-PLAN
  subdomain: planificacion_comunal
  kb_source:
    - "LOC GORE Art. 16 letra k): asesorar a municipalidades"
    - "Ley 18.695 Orgánica Constitucional de Municipalidades"
    - "dialogo_cobertura_rigurosa_dplan_dterr.md"

entity:
  id: ENT-PLAN-PLADECO
  name: PLADECO
  name_es: Plan de Desarrollo Comunal
  description: |
    Instrumento rector del desarrollo local que toda municipalidad debe
    elaborar y mantener actualizado. Define la visión, objetivos y líneas
    de acción para el desarrollo comunal a 4-8 años.

    El GORE de Ñuble debe articular su inversión regional con los 21
    PLADECOs vigentes para asegurar coherencia territorial.

    Según Art. 7 de Ley 18.695: "El plan comunal de desarrollo constituirá
    el instrumento rector del desarrollo en la comuna."

  purpose: |
    Modelar PLADECOs para:
    - Verificar alineamiento ERD ↔ PLADECO
    - Fundamentar inversión IPR en visión comunal
    - Apoyar asistencia técnica municipal (M7)
    - Monitorear vigencia de planes comunales

  categorical_type: Object
  is_abstract: false
  category: Reference

attributes:
  - name: id_pladeco
    type: String
    key: true
    description: Identificador único

  - name: comuna_id
    type: String
    fk: ENT-TERR-COMUNA
    nullable: false
    description: Comuna que rige

  - name: nombre
    type: String
    nullable: false
    description: "Nombre del plan (ej: PLADECO Chillán 2024-2028)"

  # Vigencia
  - name: periodo_inicio
    type: Integer
    nullable: false
    description: Año de inicio de vigencia

  - name: periodo_fin
    type: Integer
    nullable: false
    description: Año de término de vigencia

  - name: fecha_aprobacion
    type: Date
    nullable: true
    description: Fecha de aprobación por Concejo Municipal

  - name: decreto_aprobatorio
    type: String
    nullable: true
    description: Número del decreto alcaldicio aprobatorio

  # Estado
  - name: estado
    type: Enum[Vigente, Vencido, EnActualizacion, Borrador]
    default: Vigente
    description: Estado del instrumento

  # Contenido
  - name: vision
    type: Text
    nullable: true
    description: Visión de desarrollo comunal

  - name: ejes_count
    type: Integer
    nullable: true
    description: Cantidad de ejes estratégicos

  - name: objetivos_count
    type: Integer
    nullable: true
    description: Cantidad de objetivos específicos

  # Alineamiento ERD
  - name: alineado_erd
    type: Boolean
    default: false
    description: ¿Se ha verificado alineamiento con ERD regional?

  - name: fecha_verificacion_erd
    type: Date
    nullable: true
    description: Fecha de última verificación de alineamiento

  - name: brechas_alineamiento
    type: Text
    nullable: true
    description: Descripción de brechas detectadas con ERD

  # Documento
  - name: url_documento
    type: String
    nullable: true
    description: URL del documento público

  - name: url_sintesis
    type: String
    nullable: true
    description: URL de síntesis ejecutiva

morphisms:
  rige: [ENT-TERR-COMUNA]
  alineado_con: [ENT-PLAN-ERD]
  fundamenta: [ENT-FIN-IPR]
  asistido_por: [DIPLADE]

invariants:
  - name: periodo_valido
    condition: "periodo_fin > periodo_inicio"
    severity: CRITICAL

  - name: comuna_existente
    condition: "comuna_id EXISTS in Comuna"
    severity: CRITICAL

  - name: vigencia_coherente
    condition: "estado = 'Vigente' IMPLIES periodo_fin >= CURRENT_YEAR"
    severity: HIGH

lifecycle:
  states:
    - name: Borrador
      description: En proceso de elaboración municipal
    - name: Vigente
      description: Aprobado por Concejo y dentro del período
    - name: Vencido
      description: Período expirado sin actualización
    - name: EnActualizacion
      description: Proceso de actualización en curso

audit:
  fields_tracked:
    - estado
    - alineado_erd
  retention_years: 20
