_meta:
  urn: urn:goreos:entity:d_seg:ENT-SEG-EVIDENCIA:1.0.0
  type: Entity
  schema: urn:goreos:schema:entity:1.0.0
category: Master
is_abstract: false
attributes:
- name: id_evidencia
  type: String
  key: true
- name: incidente_id
  type: String
  fk: ENT-SEG-INCIDENTE
  nullable: false
- name: descripcion
  type: Text
  nullable: false
- name: tipo
  type: Enum[Disco, Memoria, Logs, TraficoRed, Documento, Hardware, Otro]
  nullable: false
- name: hash_md5
  type: String
  nullable: true
  description: Hash MD5 (Legacy)
- name: hash_sha256
  type: String
  nullable: false
  description: Hash SHA-256 (Estándar actual)
- name: cadena_custodia_log
  type: Text
  nullable: false
  description: Registro de quién recolectó, almacenó y accedió (JSON o Texto)
- name: recolectada_por_id
  type: String
  fk: ENT-BACK-FUNCIONARIO
  nullable: false
- name: fecha_recoleccion
  type: Timestamp
  nullable: false
- name: ubicacion_almacenamiento
  type: String
  nullable: false
  description: Lugar físico o lógico seguro (Caja fuerte, S3 Inmutable)
- name: estado
  type: Enum[Recolectada, Analizada, Preservada, Destruida, EntregadaFiscalia]
  default: Recolectada
invariants:
- id: INV-EVID-001
  name: integridad_hash
  rule: hash_sha256 IS NOT NULL
  description: Evidencia debe tener Hash SHA-256 para integridad
id: ENT-SEG-EVIDENCIA
urn: urn:goreos:entity:d_seg:ENT-SEG-EVIDENCIA:1.0.0
name: Evidencia
domain: D-SEG
