_meta:
  urn: urn:goreos:entity:d_seg:ENT-SEG-VULNERABILIDADTECNICA:1.0.0
  type: Entity
  schema: urn:goreos:schema:entity:1.0.0
category: Master
is_abstract: false
attributes:
- name: id_vulnerabilidad
  type: String
  key: true
  description: ID interno o scanner ID
- name: cve_id
  type: String
  nullable: true
  description: 'Identificador CVE (ej: CVE-2024-1234)'
- name: nombre
  type: String
  nullable: false
  description: 'Nombre descriptivo (ej: SQL Injection en Login)'
- name: cvss_score
  type: Decimal
  nullable: false
  description: Puntaje Base (0.0 - 10.0)
- name: cvss_vector
  type: String
  nullable: true
  description: 'Vector string (ej: CVSS:3.1/AV:N/AC:L...)'
- name: severidad
  type: Enum[Baja, Media, Alta, Critica]
  computed: true
  formula: "CASE \n  WHEN cvss_score >= 9.0 THEN 'Critica'\n  WHEN cvss_score >= 7.0\
    \ THEN 'Alta'\n  WHEN cvss_score >= 4.0 THEN 'Media'\n  ELSE 'Baja'\nEND\n"
- name: activo_afectado_id
  type: String
  fk: ENT-SEG-ACTIVO-INFORMACION
  nullable: false
- name: estado
  type: Enum[Nueva, EnAnalisis, ParcheProgramado, Mitigada, FalsoPositivo, Aceptada]
  default: Nueva
- name: fecha_deteccion
  type: Date
  nullable: false
- name: fecha_resolucion
  type: Date
  nullable: true
- name: parche_aplicado
  type: String
  nullable: true
  description: Versión de software/firmware que corrige
invariants:
- id: INV-VULN-001
  name: resuelta_requiere_fecha
  rule: estado = 'Mitigada' → fecha_resolucion IS NOT NULL
  description: Vulnerabilidad mitigada debe tener fecha
id: ENT-SEG-VULNERABILIDADTECNICA
urn: urn:goreos:entity:d_seg:ENT-SEG-VULNERABILIDADTECNICA:1.0.0
name: Vulnerabilidadtecnica
domain: D-SEG
