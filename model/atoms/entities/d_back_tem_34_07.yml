_meta:
  urn: urn:goreos:entity:d_back:ENT-BACK-TEM_34_07:1.0.0
  type: Entity
  schema: urn:goreos:schema:entity:1.0.0
category: Master
is_abstract: false
attributes:
- name: id_deuda_flotante
  type: String
  key: true
  description: Identificador único
- name: ejercicio_origen
  type: Integer
  nullable: false
  description: Año en que se generó el compromiso original
- name: ejercicio_pago
  type: Integer
  nullable: false
  description: Año en que se paga (ejercicio_origen + 1)
- name: compromiso_origen_id
  type: String
  fk: ENT-FIN-COMPROMISO
  nullable: false
  description: Compromiso que generó la deuda
- name: devengado_origen_id
  type: String
  fk: ENT-FIN-DEVENGO
  nullable: false
  description: Devengado pendiente de pago
- name: documento_respaldo
  type: String
  nullable: false
  description: Factura, boleta u otro documento
- name: acreedor_rut
  type: String
  nullable: false
  description: RUT del acreedor
- name: acreedor_nombre
  type: String
  nullable: false
  description: Nombre o razón social
- name: monto_original
  type: Decimal
  nullable: false
  description: Monto del devengado al cierre
- name: monto_pagado
  type: Decimal
  default: 0
  description: Monto ya cancelado
- name: saldo_pendiente
  type: Decimal
  computed: true
  formula: monto_original - monto_pagado
  description: Monto por pagar
- name: imputacion_original
  type: String
  nullable: false
  description: Clasificador presupuestario del compromiso original
- name: imputacion_item3407
  type: String
  default: 34.07.001
  description: Clasificador del ítem de deuda flotante
- name: fecha_devengado
  type: Date
  nullable: false
  description: Fecha del devengado original
- name: fecha_cierre_ejercicio
  type: Date
  nullable: false
  description: 31/12 del ejercicio origen
- name: fecha_pago
  type: Date
  nullable: true
  description: Fecha de extinción de la obligación
- name: dias_pendiente
  type: Integer
  computed: true
  formula: fecha_actual - fecha_cierre_ejercicio
  description: Días desde cierre sin pagar
- name: estado
  type: Enum[Pendiente, EnTramitePago, Pagado, Prescrito, EnDisputa]
  default: Pendiente
  description: Estado de la deuda
- name: pago_id
  type: String
  fk: ENT-BACK-PAGO
  nullable: true
  description: Pago que extinguió la deuda
- name: folio_sigfe_original
  type: String
  nullable: true
  description: Folio SIGFE del devengado origen
- name: folio_sigfe_pago
  type: String
  nullable: true
  description: Folio SIGFE del pago
- name: motivo_atraso
  type: String
  nullable: true
  description: Razón del no pago en ejercicio anterior
- name: notas
  type: Text
  nullable: true
  description: Observaciones adicionales
invariants:
- id: INV-DF-001
  name: ejercicio_correlativo
  rule: ejercicio_pago = ejercicio_origen + 1
  description: El pago debe ser en el ejercicio siguiente
  severity: error
- id: INV-DF-002
  name: monto_pagado_no_excede
  rule: monto_pagado <= monto_original
  description: No se puede pagar más del monto original
  severity: error
- id: INV-DF-003
  name: pagado_tiene_pago
  rule: '(estado = ''Pagado'') → pago_id IS NOT NULL

    '
  description: Estado pagado requiere referencia al pago
  severity: error
- id: INV-DF-004
  name: plazo_maximo_pago
  rule: "(estado = 'Pendiente' AND dias_pendiente > 365) → \nestado = 'Prescrito'\
    \ OR estado = 'EnDisputa'\n"
  description: Alertar deudas de más de un año
  source: DL 1263
id: ENT-BACK-TEM_34_07
urn: urn:goreos:entity:d_back:ENT-BACK-TEM_34_07:1.0.0
name: Tem 34 07
domain: D-BACK
