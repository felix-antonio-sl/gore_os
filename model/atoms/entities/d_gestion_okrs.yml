_meta:
  urn: urn:goreos:entity:unknown:unknown:1.0.0
  type: Entity
  schema: urn:goreos:schema:entity:1.0.0
category: Master
is_abstract: false
attributes:
- name: id_okr
  type: String
  key: true
  description: 'Identificador único (ej: OKR-2025-DAF-01)'
- name: codigo
  type: String
  nullable: true
  description: Código corto
- name: erd_id
  type: String
  fk: ENT-PLAN-ERD
  nullable: false
  description: ERD vigente
- name: objetivo_estrategico_id
  type: String
  fk: ENT-PLAN-OBJETIVO-ESTRATEGICO
  nullable: true
  description: Objetivo estratégico origen
- name: eje_id
  type: String
  fk: ENT-PLAN-EJE
  nullable: true
  description: Eje estratégico ERD
- name: division_id
  type: String
  fk: ENT-BACK-DIVISION
  nullable: false
  description: División responsable
- name: poa_id
  type: String
  fk: ENT-GESTION-POA
  nullable: true
  description: POA donde se implementa
- name: objetivo
  type: Text
  nullable: false
  description: 'Objective: meta cualitativa inspiracional'
- name: descripcion
  type: Text
  nullable: true
  description: Descripción ampliada
- name: periodo
  type: Enum[Trimestral, Semestral, Anual]
  default: Anual
  description: Período del OKR
- name: año
  type: Integer
  nullable: false
- name: trimestre
  type: Integer
  nullable: true
  description: Trimestre (1-4) si es trimestral
- name: fecha_inicio
  type: Date
  nullable: false
- name: fecha_fin
  type: Date
  nullable: false
- name: key_results
  type: JSON
  nullable: false
  description: "Resultados clave:\n[{\n  \"kr_id\": \"KR1\",\n  \"descripcion\": \"\
    ...\",\n  \"meta\": 100,\n  \"actual\": 0,\n  \"unidad\": \"%\",\n  \"peso\":\
    \ 0.33\n}]\n"
- name: total_krs
  type: Integer
  default: 0
- name: krs_cumplidos
  type: Integer
  default: 0
- name: avance_porcentual
  type: Decimal
  computed: true
  formula: AVG(key_results[*].actual / key_results[*].meta) * 100
- name: estado
  type: Enum[Borrador, Activo, EnRevision, Cerrado]
  default: Borrador
- name: owner_id
  type: String
  fk: ENT-BACK-FUNCIONARIO
  nullable: false
  description: Responsable del OKR
- name: sponsor_id
  type: String
  fk: ENT-BACK-FUNCIONARIO
  nullable: true
  description: Sponsor (jefatura)
- name: score_final
  type: Decimal
  nullable: true
  description: Score final (0.0-1.0)
- name: resultado
  type: Enum[Superado, Cumplido, Parcial, NoCumplido]
  nullable: true
invariants:
- id: INV-OKR-001
  name: minimo_tres_krs
  rule: total_krs >= 3
  description: Mínimo 3 key results por OKR
  severity: warning
- id: INV-OKR-002
  name: pesos_krs_suman_uno
  rule: SUM(key_results[*].peso) = 1.0
  description: Pesos de KRs deben sumar 100%
