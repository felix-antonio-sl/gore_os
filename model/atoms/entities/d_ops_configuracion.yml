# ==============================================================================
# GORE_OS Entity Atom: Configuracion
# ==============================================================================
# Domain: D-OPS (Operaciones del Sistema)
# Subdomain: Configuración (M6)
# ==============================================================================

_metadata:
  version: "1.0.0"
  status: active
  created_at: "2025-12-22"
  created_by: "Ingeniero Software Composicional"
  domain: D-OPS
  subdomain: configuracion

entity:
  id: ENT-OPS-CONFIGURACION
  name: Configuracion
  name_es: Configuración del Sistema
  description: |
    Parámetro de configuración del sistema por ambiente.
    Permite gestión centralizada y versionada de settings.

  purpose: |
    Modelar configuraciones para:
    - Gestión de parámetros por ambiente
    - Versionamiento de configuraciones
    - Auditoría de cambios

  categorical_type: Configuration
  is_abstract: false
  category: ConfigManagement

attributes:
  - name: id_config
    type: String
    key: true

  - name: clave
    type: String
    nullable: false
    description: "Nombre del parámetro (ej: MAX_UPLOAD_SIZE)"

  - name: valor
    type: String
    nullable: false

  - name: tipo_valor
    type: Enum[String, Integer, Boolean, Json, Secret]
    default: String

  - name: ambiente
    type: Enum[Development, Staging, Production, All]
    nullable: false

  - name: descripcion
    type: String
    nullable: true

  - name: categoria
    type: String
    nullable: true
    description: "Agrupación lógica"

  - name: version
    type: Integer
    default: 1

  - name: es_secreto
    type: Boolean
    default: false
    description: "Si el valor debe ocultarse en logs"

  - name: modificado_por_id
    type: String
    fk: ENT-OPS-USUARIO-SISTEMA
    nullable: true

  - name: fecha_modificacion
    type: DateTime
    nullable: true

invariants:
  - id: INV-CFG-001
    name: clave_unica_ambiente
    rule: UNIQUE(clave, ambiente)
    description: "Clave única por ambiente"

  - id: INV-CFG-002
    name: secreto_tipo_consistente
    rule: es_secreto = true → tipo_valor = 'Secret'
    description: "Secretos deben marcarse correctamente"

morphisms:
  modificado_por: [ENT-OPS-USUARIO-SISTEMA]

audit:
  fields_tracked:
    - valor
    - version
  retention_years: 5
