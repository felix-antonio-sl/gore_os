_meta:
  urn: urn:goreos:entity:unknown:unknown:1.0.0
  type: Entity
  schema: urn:goreos:schema:entity:1.0.0
category: Master
is_abstract: false
attributes:
- name: id_ipt
  type: String
  key: true
  description: Identificador único
- name: tipo
  type: Enum[PRC, PRI, LimiteUrbano, Seccional, PROT]
  nullable: false
  description: Tipo de instrumento
- name: nombre
  type: String
  nullable: false
  description: 'Nombre del instrumento (ej: PRC Chillán 2018)'
- name: comuna_id
  type: String
  fk: ENT-TERR-COMUNA
  nullable: true
  description: Comuna (aplica a PRC, Límite Urbano, Seccional)
- name: comunas_ids
  type: List[String]
  nullable: true
  description: Comunas cubiertas (aplica a PRI)
- name: cobertura_regional
  type: Boolean
  default: false
  description: ¿Cubre toda la región? (aplica a PROT)
- name: estado
  type: Enum[Vigente, Modificacion, Estudio, Derogado, Historico]
  default: Vigente
  description: Estado del instrumento
- name: fecha_publicacion_do
  type: Date
  nullable: true
  description: Fecha de publicación en Diario Oficial
- name: decreto_aprobatorio
  type: String
  nullable: true
  description: 'Decreto/Resolución (ej: DA 123/2018, Res. GORE 45/2023)'
- name: memoria_explicativa_url
  type: String
  nullable: true
  description: URL de la memoria explicativa
- name: ordenanza_local_url
  type: String
  nullable: true
  description: URL de la ordenanza local
- name: planos_url
  type: String
  nullable: true
  description: URL de planos reguladores
- name: antiguedad_anos
  type: Integer
  nullable: true
  description: Años desde publicación (derivado)
- name: requiere_actualizacion
  type: Boolean
  default: false
  description: ¿Supera 10 años sin actualización?
- name: capa_geoespacial_id
  type: String
  fk: ENT-TERR-CAPA
  nullable: true
  description: Capa GIS asociada
- name: ipt_superior_id
  type: String
  fk: ENT-TERR-IPT
  nullable: true
  description: IPT de nivel superior (PRC → PRI → PROT)
invariants:
- name: tipo_territorio_coherente
  condition: '(tipo = ''PRC'' AND comuna_id IS NOT NULL) OR

    (tipo = ''PRI'' AND comunas_ids IS NOT NULL) OR

    (tipo = ''PROT'' AND cobertura_regional = TRUE)

    '
  severity: CRITICAL
- name: jerarquia_valida
  condition: 'tipo = ''PRC'' IMPLIES ipt_superior_id.tipo IN (''PRI'', ''PROT'', NULL)

    '
  severity: HIGH
- name: antiguedad_alerta
  condition: antiguedad_anos > 10 IMPLIES requiere_actualizacion = TRUE
  severity: MEDIUM
