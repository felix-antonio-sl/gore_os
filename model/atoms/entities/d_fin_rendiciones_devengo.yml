_meta:
  urn: urn:goreos:entity:d-fin:devengo:1.0.0
  type: Entity
  schema: urn:goreos:schema:entity:1.0.0
id: ENT-FIN-DEVENGO
urn: urn:goreos:entity:d-fin:devengo:1.0.0
name: Devengo Contable
domain: D-FIN
subdomain: rendiciones
category: Transaction
is_abstract: false
attributes:
- name: id_devengo
  type: String
  key: true
- name: fecha_devengo
  type: Date
  nullable: false
- name: glosa_contable
  type: String
  nullable: false
- name: monto_devengado
  type: Decimal
  nullable: false
- name: moneda
  type: Enum[CLP, UF, USD]
  default: CLP
- name: imputacion_presupuestaria
  type: String
  nullable: false
  description: Código clasificador presupuestario (ej. 24.01.001)
- name: cdp_id
  type: String
  fk: ENT-FIN-CDP
  nullable: false
  description: Certificado que avala la disponibilidad
- name: documento_respaldo_tipo
  type: Enum[Factura, BoletaHonorarios, EstadoPago, Resolucion, Sentencia]
  nullable: false
- name: documento_respaldo_id
  type: String
  nullable: false
  description: ID interno o externo del documento
- name: folio_sigfe
  type: String
  nullable: true
  description: ID de la transacción en sistema nacional SIGFE
- name: ipr_id
  type: String
  fk: ENT-FIN-IPR
  nullable: true
- name: estado
  type: Enum[Borrador, Validado, Contabilizado, Anulado]
  default: Borrador
invariants:
- name: devengo_con_respaldo
  rule: monto_devengado <= cdp.saldo_disponible
- name: sigfe_obligatorio
  rule: IF estado = Contabilizado THEN folio_sigfe NOT NULL
