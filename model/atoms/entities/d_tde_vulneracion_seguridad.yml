_meta:
  urn: urn:goreos:entity:d_tde:ENT-TDE-VULNERACION_SEGURIDAD:1.0.0
  type: Entity
  schema: urn:goreos:schema:entity:1.0.0
category: Master
is_abstract: false
attributes:
- name: id_vulneracion
  type: String
  key: true
- name: responsable_id
  type: String
  fk: ENT-TDE-RESPONSABLE-TRATAMIENTO
  nullable: false
- name: fecha_deteccion
  type: Timestamp
  nullable: false
- name: fecha_ocurrencia_estimada
  type: Timestamp
  nullable: true
- name: naturaleza
  type: Enum[Destruccion, Filtracion, Perdida, Alteracion, AccesoNoAutorizado, ComunicacionNoAutorizada]
  nullable: false
- name: descripcion
  type: String
  nullable: false
- name: categorias_datos_afectados
  type: Array[Enum[DatosIdentificacion, DatosSensibles, DatosSalud, DatosBiometricos,
    DatosNNA, DatosFinancieros]]
  nullable: false
- name: numero_titulares_afectados
  type: Integer
  nullable: true
  description: Número aproximado
- name: riesgo_para_titulares
  type: Enum[Bajo, Medio, Alto, MuyAlto]
  nullable: false
- name: fecha_reporte_agencia
  type: Timestamp
  nullable: true
- name: reporte_agencia_expedito
  type: Boolean
  computed: true
  formula: fecha_reporte_agencia IS NOT NULL AND (fecha_reporte_agencia - fecha_deteccion)
    <= 72 HOURS
  description: Reportado sin dilaciones indebidas (referencia 72h)
- name: requiere_comunicacion_titulares
  type: Boolean
  computed: true
  formula: '''DatosSensibles'' IN categorias_datos_afectados OR ''DatosNNA'' IN categorias_datos_afectados
    OR ''DatosFinancieros'' IN categorias_datos_afectados'
- name: fecha_comunicacion_titulares
  type: Timestamp
  nullable: true
- name: medio_comunicacion
  type: Enum[Individual, MassComunicacion]
  nullable: true
  description: Individual o aviso en medio masivo si no es posible
- name: medidas_adoptadas
  type: Array[String]
  nullable: false
- name: estado
  type: Enum[Detectada, Reportada, EnGestion, Cerrada]
  default: Detectada
- name: incidente_seguridad_id
  type: String
  fk: ENT-SEG-INCIDENTE
  nullable: true
  description: Si se gestiona también como Incidente de Seguridad
invariants:
- id: INV-VUL-001
  name: reporte_obligatorio
  rule: riesgo_para_titulares IN ('Alto', 'MuyAlto') → fecha_reporte_agencia IS NOT
    NULL
  description: Brechas de alto riesgo deben reportarse a la APDP
- id: INV-VUL-002
  name: comunicacion_titulares_sensibles
  rule: requiere_comunicacion_titulares = TRUE → fecha_comunicacion_titulares IS NOT
    NULL
  description: Si afecta datos sensibles/NNA/financieros, debe comunicarse a titulares
id: ENT-TDE-VULNERACION_SEGURIDAD
urn: urn:goreos:entity:d_tde:ENT-TDE-VULNERACION_SEGURIDAD:1.0.0
name: Vulneracion Seguridad
domain: D-TDE
