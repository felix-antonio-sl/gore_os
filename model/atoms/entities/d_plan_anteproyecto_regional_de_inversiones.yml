_meta:
  urn: urn:goreos:entity:unknown:unknown:1.0.0
  type: Entity
  schema: urn:goreos:schema:entity:1.0.0
category: Master
is_abstract: false
attributes:
- name: id_ari
  type: String
  key: true
  description: Identificador único (ej. ARI-2025)
- name: año_fiscal
  type: Integer
  nullable: false
  description: Año presupuestario objetivo
- name: erd_id
  type: String
  fk: ENT-PLAN-ERD
  nullable: false
  description: ERD vigente para el ARI
- name: fecha_apertura_solicitudes
  type: Date
  nullable: true
  description: Inicio período de solicitud (abril)
- name: fecha_cierre_solicitudes
  type: Date
  nullable: true
  description: Fin período de solicitud (junio)
- name: fecha_priorizacion
  type: Date
  nullable: true
  description: Fecha consolidación técnica
- name: fecha_presentacion_core
  type: Date
  nullable: true
  description: Sesión CORE de presentación
- name: acuerdo_core_aprobatorio
  type: String
  nullable: true
  description: Número de acuerdo CORE
- name: fecha_aprobacion
  type: Date
  nullable: true
  description: Fecha sesión aprobatoria
- name: monto_total_solicitado
  type: Decimal
  default: 0
  description: Suma de solicitudes en M$
- name: monto_asignado
  type: Decimal
  default: 0
  description: Monto final aprobado CORE en M$
- name: cantidad_iniciativas
  type: Integer
  default: 0
  description: Número de LineaARI
- name: iniciativas_priorizadas
  type: Integer
  default: 0
  description: Iniciativas con asignación > 0
- name: estado
  type: Enum[EnElaboracion, EnPriorizacion, PresentadoCORE, Aprobado, Ejecutando]
  default: EnElaboracion
  description: Estado del ciclo ARI
- name: monto_fndr
  type: Decimal
  default: 0
  description: Asignación FNDR
- name: monto_frpd
  type: Decimal
  default: 0
  description: Asignación Royalty
- name: monto_isar
  type: Decimal
  default: 0
  description: Asignación Inversión Sectorial
- name: monto_8porciento
  type: Decimal
  default: 0
  description: Asignación 8% Subvención
invariants:
- id: INV-ARI-001
  name: monto_coherente
  rule: monto_asignado <= monto_total_solicitado
  description: No se puede asignar más de lo solicitado
  severity: error
- id: INV-ARI-002
  name: suma_fuentes
  rule: monto_fndr + monto_frpd + monto_isar + monto_8porciento = monto_asignado
  description: La suma de fuentes debe igualar el monto asignado
  severity: warning
- id: INV-ARI-003
  name: aprobacion_requiere_core
  rule: '(estado = ''Aprobado'') → (acuerdo_core_aprobatorio IS NOT NULL)

    '
  description: Estado Aprobado requiere acuerdo CORE
