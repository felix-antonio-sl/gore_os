_meta:
  urn: urn:goreos:entity:d_fin:ENT-FIN-RENDICIONES_OBSERVACION:1.0.0
  type: Entity
  schema: urn:goreos:schema:entity:1.0.0
category: Master
is_abstract: false
attributes:
- name: id_observacion
  type: String
  key: true
- name: rendicion_id
  type: String
  fk: ENT-FIN-RENDICION
  nullable: false
- name: codigo_observacion
  type: String
  nullable: false
  description: Código tipificado (ej. OBS-FORMAL-001)
- name: tipo
  type: Enum[Formal, Sustantiva, Documental, Contable]
  nullable: false
- name: severidad
  type: Enum[Leve, Moderada, Grave, Critica]
  default: Moderada
- name: descripcion
  type: Text
  nullable: false
  description: Detalle del reparo
- name: fundamento_legal
  type: String
  nullable: true
  description: Artículo o norma infringida
- name: monto_observado
  type: Decimal
  nullable: true
  description: Monto específico con reparo
- name: item_presupuestario
  type: String
  nullable: true
  description: Ítem del presupuesto afectado
- name: informe_id
  type: String
  fk: ENT-FIN-INFORME-RENDICION
  nullable: true
  description: Documento específico observado
- name: fecha_emision
  type: Date
  nullable: false
- name: emitida_por_id
  type: String
  fk: ROL-ANALISTA-RENDICIONES
  nullable: false
- name: visada_por_id
  type: String
  fk: ROL-JEFE-UCR
  nullable: true
- name: estado
  type: Enum[Pendiente, Notificada, EnRespuesta, Subsanada, NoSubsanada, Reintegro]
  default: Pendiente
- name: fecha_notificacion
  type: Date
  nullable: true
  description: Fecha en que se notificó al ejecutor
- name: plazo_respuesta_dias
  type: Integer
  default: 15
  description: Días hábiles para subsanar
- name: fecha_vencimiento
  type: Date
  computed: true
  description: fecha_notificacion + plazo_respuesta_dias
- name: fecha_respuesta
  type: Date
  nullable: true
- name: respuesta_ejecutor
  type: Text
  nullable: true
- name: url_documento_respuesta
  type: String
  nullable: true
- name: respondida_en_plazo
  type: Boolean
  computed: true
  formula: fecha_respuesta <= fecha_vencimiento
- name: decision_final
  type: Enum[Acepta, Rechaza, Reintegro]
  nullable: true
- name: fecha_cierre
  type: Date
  nullable: true
- name: resolucion_cierre
  type: String
  nullable: true
  description: Resolución que declara subsanada o rechazada
- name: monto_reintegro
  type: Decimal
  nullable: true
  description: Monto a reintegrar si decision = Reintegro
- name: reintegro_id
  type: String
  fk: ENT-FIN-REINTEGRO
  nullable: true
invariants:
- id: INV-OBS-001
  name: descripcion_obligatoria
  rule: descripcion IS NOT NULL AND LENGTH(descripcion) > 10
  description: Toda observación debe estar fundamentada
- id: INV-OBS-002
  name: notificacion_antes_respuesta
  rule: fecha_respuesta IS NOT NULL → fecha_notificacion IS NOT NULL
  description: No puede haber respuesta sin notificación previa
- id: INV-OBS-003
  name: reintegro_requiere_monto
  rule: decision_final = 'Reintegro' → monto_reintegro IS NOT NULL AND monto_reintegro
    > 0
  description: Decisión de reintegro requiere monto
- id: INV-OBS-004
  name: cierre_requiere_decision
  rule: fecha_cierre IS NOT NULL → decision_final IS NOT NULL
  description: El cierre requiere decisión
id: ENT-FIN-RENDICIONES_OBSERVACION
urn: urn:goreos:entity:d_fin:ENT-FIN-RENDICIONES_OBSERVACION:1.0.0
name: Rendiciones Observacion
domain: D-FIN
