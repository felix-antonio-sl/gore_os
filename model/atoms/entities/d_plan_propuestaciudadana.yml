# ==============================================================================
# GORE_OS Entity Atom: PropuestaCiudadana (Aporte Ciudadano)
# ==============================================================================
# Domain: D-PLAN (Strategic Planning)
# Subdomain: Participación
# Source: domain_d-plan.md M6, dialogo_dplan_dterr.md
# ==============================================================================

_metadata:
  version: "1.0.0"
  status: active
  created_at: "2025-12-21"
  created_by: "Arquitecto Categórico + Gobernador Virtual"
  domain: D-PLAN
  subdomain: participacion
  kb_source:
    - "domain_d-plan.md M6"
    - "dialogo_dplan_dterr.md"

entity:
  id: ENT-PLAN-PROPUESTA
  name: PropuestaCiudadana
  name_es: Propuesta Ciudadana
  description: |
    Aporte o propuesta recogida en una instancia de participación ciudadana.
    Debe tener trazabilidad hacia iniciativas de inversión para demostrar
    incidencia de la participación en las decisiones del GORE.

  purpose: |
    Modelar propuestas para:
    - Registrar aportes ciudadanos
    - Trazar propuesta a iniciativa
    - Demostrar incidencia ciudadana
    - Reportar estado de propuestas

  categorical_type: Object
  is_abstract: false
  category: Transactional

attributes:
  - name: id_propuesta
    type: String
    key: true
    description: Identificador único

  - name: cabildo_id
    type: String
    fk: ENT-PLAN-CABILDO
    nullable: false
    description: Cabildo donde se recogió

  - name: descripcion
    type: Text
    nullable: false
    description: Contenido de la propuesta

  - name: categoria
    type: Enum[Infraestructura, Social, Economico, Ambiental, Cultural, Seguridad, Salud, Educacion, Otro]
    nullable: false
    description: Categoría temática

  - name: subcategoria
    type: String
    nullable: true
    description: Subcategoría específica

  # Proponente
  - name: proponente_tipo
    type: Enum[Persona, Organizacion, Anonimo]
    default: Anonimo
    description: Tipo de proponente

  - name: proponente_nombre
    type: String
    nullable: true
    description: Nombre si consiente

  - name: organizacion
    type: String
    nullable: true
    description: Organización representada

  # Análisis
  - name: eje_erd_sugerido
    type: String
    fk: ENT-PLAN-EJE
    nullable: true
    description: Eje ERD al que podría aportar

  - name: objetivo_erd_sugerido
    type: String
    fk: ENT-PLAN-OE
    nullable: true
    description: OE específico relacionado

  # Trazabilidad
  - name: estado_trazabilidad
    type: Enum[Recibida, EnAnalisis, Vinculada, NoVinculable, Descartada, Ejecutada]
    default: Recibida
    description: Estado de la trazabilidad

  - name: iniciativa_vinculada_id
    type: String
    fk: ENT-FIN-IPR
    nullable: true
    description: IPR que responde a esta propuesta

  - name: justificacion_vinculacion
    type: Text
    nullable: true
    description: Justificación del vínculo o descarte

  - name: fecha_vinculacion
    type: Date
    nullable: true
    description: Fecha de decisión de vinculación

  # Síntesis IA
  - name: sintesis_ia
    type: Text
    nullable: true
    description: Síntesis generada por IA

  - name: keywords
    type: Array[String]
    nullable: true
    description: Palabras clave extraídas

invariants:
  - id: INV-PROP-001
    name: vinculada_requiere_ipr
    rule: |
      (estado_trazabilidad = 'Vinculada') → (iniciativa_vinculada_id IS NOT NULL)
    description: Estado vinculada requiere IPR

morphisms:
  originada_en: [ENT-PLAN-CABILDO]
  alineada_con: [ENT-PLAN-OE, ENT-PLAN-EJE]
  vinculada_a: [ENT-FIN-IPR]

audit:
  fields_tracked:
    - estado_trazabilidad
    - iniciativa_vinculada_id
  retention_years: 10
