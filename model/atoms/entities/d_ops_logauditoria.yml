_meta:
  urn: urn:goreos:entity:d_ops:ENT-OPS-LOGAUDITORIA:1.0.0
  type: Entity
  schema: urn:goreos:schema:entity:1.0.0
category: Master
is_abstract: false
attributes:
- name: id_log
  type: String
  key: true
- name: timestamp
  type: DateTime
  nullable: false
- name: usuario_id
  type: String
  fk: ENT-OPS-USUARIO-SISTEMA
  nullable: true
  description: NULL si es acción de sistema
- name: accion
  type: String
  nullable: false
  description: Tipo de acción (CREATE, UPDATE, DELETE, LOGIN, etc.)
- name: recurso_tipo
  type: String
  nullable: false
  description: Tipo de entidad afectada
- name: recurso_id
  type: String
  nullable: true
  description: ID de la entidad afectada
- name: cambios
  type: Json
  nullable: true
  description: Detalle de cambios (before/after)
- name: ip_origen
  type: String
  nullable: true
- name: user_agent
  type: String
  nullable: true
- name: resultado
  type: Enum[Exito, Fallido, Denegado]
  default: Exito
- name: motivo_fallo
  type: String
  nullable: true
invariants:
- id: INV-LOG-001
  name: fallido_tiene_motivo
  rule: resultado IN ('Fallido', 'Denegado') → motivo_fallo IS NOT NULL
  description: Acción fallida debe tener motivo
- id: INV-LOG-002
  name: inmutable
  rule: IMMUTABLE after INSERT
  description: Logs de auditoría son inmutables
id: ENT-OPS-LOGAUDITORIA
urn: urn:goreos:entity:d_ops:ENT-OPS-LOGAUDITORIA:1.0.0
name: Logauditoria
domain: D-OPS
