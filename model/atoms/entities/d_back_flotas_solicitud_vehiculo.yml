_meta:
  urn: urn:goreos:entity:d-back:solicitud-vehiculo:1.0.0
  type: Entity
  schema: urn:goreos:schema:entity:1.0.0
id: ENT-BACK-SOLICITUD_VEHICULO
urn: urn:goreos:entity:d-back:solicitud-vehiculo:1.0.0
name: Solicitud de Vehículo
domain: D-BACK
subdomain: flotas
category: Transactional
is_abstract: false
attributes:
- name: id_solicitud
  type: String
  key: true
- name: numero_solicitud
  type: String
  nullable: true
- name: solicitante_id
  type: String
  fk: ENT-BACK-FUNCIONARIO
  nullable: false
- name: division_solicitante
  type: String
  nullable: true
- name: jefatura_aprobador_id
  type: String
  fk: ENT-BACK-FUNCIONARIO
  nullable: true
- name: fecha_hora_salida
  type: DateTime
  nullable: false
- name: fecha_hora_retorno_estimada
  type: DateTime
  nullable: false
- name: fecha_hora_retorno_real
  type: DateTime
  nullable: true
- name: destino
  type: String
  nullable: false
- name: proposito
  type: Text
  nullable: false
- name: numero_pasajeros
  type: Integer
  default: 1
- name: vehiculo_asignado_id
  type: String
  fk: ENT-BACK-VEHICULO
  nullable: true
- name: conductor_asignado_id
  type: String
  fk: ENT-BACK-CONDUCTOR
  nullable: true
- name: encargado_flota_id
  type: String
  fk: ENT-BACK-FUNCIONARIO
  nullable: true
- name: estado
  type: Enum[Borrador, Solicitada, AprobadaJefatura, Rechazada, Asignada, EnCurso,
    Completada, Cancelada, SinVehiculo]
  default: Borrador
- name: fecha_aprobacion
  type: DateTime
  nullable: true
- name: motivo_rechazo
  type: Text
  nullable: true
- name: requiere_autorizacion_fds
  type: Boolean
  computed: true
  description: True si fecha_hora_salida cae en sábado, domingo o festivo
- name: autorizacion_fds_aprobada
  type: Boolean
  default: false
- name: justificacion_fds
  type: Text
  nullable: true
- name: bitacora_viaje_id
  type: String
  fk: ENT-BACK-BITACORA_VIAJE
  nullable: true
invariants:
- name: aprobacion_antes_asignacion
  rule: IF estado = Asignada THEN jefatura_aprobador_id NOT NULL
- name: fds_requiere_justificacion
  rule: IF requiere_autorizacion_fds AND autorizacion_fds_aprobada THEN justificacion_fds
    NOT NULL
- name: vehiculo_con_conductor
  rule: IF vehiculo_asignado_id NOT NULL THEN conductor_asignado_id NOT NULL
