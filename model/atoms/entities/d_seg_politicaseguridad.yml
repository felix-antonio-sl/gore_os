# ==============================================================================
# GORE_OS Entity Atom: PoliticaSeguridad (Política de Seguridad)
# ==============================================================================
# Domain: D-SEG (Ciberseguridad)
# Subdomain: M1 Gobierno y Estrategia
# Source: dialogo_riguroso_d_seg.md, ISO 27001
# ==============================================================================

_metadata:
  version: "1.0.0"
  status: active
  created_at: "2025-12-22"
  created_by: "Arquitecto Categórico + CISO Virtual"
  domain: D-SEG
  subdomain: gobernanza
  kb_source:
    - "ISO/IEC 27001:2022 A.5.1 Policies for information security"
    - "dialogo_riguroso_d_seg.md"

entity:
  id: ENT-SEG-POLITICA
  name: PoliticaSeguridad
  name_es: Política de Seguridad de Información
  description: |
    Directriz formal aprobada por la alta dirección que establece
    los principios y reglas para proteger la información.

    Jerarquía:
    - Política General (PPSI): Marco global.
    - Políticas Específicas: Control de Acceso, Backup, Escritorio Limpio.
    - Procedimientos: Pasos operativos.

  purpose: |
    Establecer marco normativo interno para:
    - Definir objetivos de seguridad
    - Asignar responsabilidades
    - Cumplir requisitos legales (Ley Marco Ciberseguridad)
    - Comunicar reglas a funcionarios y terceros

  categorical_type: Object
  is_abstract: false
  category: Configuration

attributes:
  - name: id_politica
    type: String
    key: true

  - name: nombre
    type: String
    nullable: false
    description: "Nombre oficial (ej: Política General de Seguridad)"

  - name: tipo
    type: Enum[General, Especifica, Procedimiento, Estandar, Guia]
    default: Especifica

  - name: version
    type: String
    nullable: false
    description: "Versión del documento (ej: 1.2)"

  # Vigencia
  - name: fecha_aprobacion
    type: Date
    nullable: false

  - name: aprobada_por_rol
    type: String
    fk: ENT-BACK-ROL # O Funcionario con rol Directivo
    nullable: true
    description: "Quien aprobó (Gobernador, Comité Seguridad)"

  - name: fecha_proxima_revision
    type: Date
    nullable: false
    description: "Revisión obligatoria anual (ISO requirement)"

  # Contenido
  - name: alcance
    type: Text
    nullable: true
    description: "A quién aplica (Toda la institución, Área TI, Proveedores)"

  - name: documento_url
    type: String
    nullable: true
    description: "Link al documento oficial (Alfresco/DocDigital)"

  # Estado
  - name: estado
    type: Enum[Borrador, Vigente, Obsoleta, Revocada]
    default: Vigente

  # Publicación
  - name: difundida_a_funcionarios
    type: Boolean
    default: false
    description: "¿Comunicada oficialmente?"

invariants:
  - id: INV-POL-001
    name: vigente_requiere_aprobacion
    rule: estado = 'Vigente' → fecha_aprobacion IS NOT NULL
    description: Política vigente debe estar aprobada

morphisms:
  regula: [ENT-SEG-ACTIVO-INFORMACION, ENT-BACK-FUNCIONARIO]
  satisface: [ENT-SEG-CONTROL]

audit:
  fields_tracked:
    - version
    - estado
    - fecha_proxima_revision
  retention_years: 10
