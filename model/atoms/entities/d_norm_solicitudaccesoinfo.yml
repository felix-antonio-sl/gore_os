# ==============================================================================
# GORE_OS Entity Atom: SolicitudAccesoInfo
# ==============================================================================
# Domain: D-NORM (Gestión Jurídico-Administrativa)
# Subdomain: Control Externo
# Source: Ley 20.285, KB-GN-200
# ==============================================================================

_metadata:
  version: "1.0.0"
  status: active
  created_at: "2025-12-21"
  created_by: "Arquitecto Categórico + Fiscal Virtual"
  domain: D-NORM
  subdomain: control_externo
  kb_source:
    - "Ley 20.285: Transparencia y Acceso a la Información"

entity:
  id: ENT-NORM-SAI
  name: SolicitudAccesoInfo
  name_es: Solicitud de Acceso a la Información
  description: |
    Solicitud ciudadana de acceso a información pública según
    Ley de Transparencia (Ley 20.285).

    Plazo: 20 días hábiles (prorrogable 10 días).
    Tutela: CPLT (Consejo para la Transparencia).

  purpose: |
    - Registrar SAI ciudadanas
    - Controlar plazos de respuesta
    - Cumplir Ley de Transparencia
    - Base para amparos CPLT

  categorical_type: Object
  is_abstract: false
  category: Transactional

attributes:
  - name: id_sai
    type: String
    key: true
    description: Identificador único

  - name: folio
    type: String
    nullable: false
    description: Folio de la solicitud

  # Solicitante
  - name: solicitante_nombre
    type: String
    nullable: false
    description: Nombre del solicitante

  - name: solicitante_email
    type: String
    nullable: true
    description: Email de contacto

  - name: solicitante_telefono
    type: String
    nullable: true
    description: Teléfono de contacto

  # Solicitud
  - name: fecha_ingreso
    type: Date
    nullable: false
    description: Fecha de ingreso

  - name: materia
    type: Text
    nullable: false
    description: Información solicitada

  - name: formato_entrega
    type: Enum[Digital, Papel, Ambos]
    default: Digital
    description: Formato preferido

  # Plazos
  - name: plazo_dias
    type: Integer
    default: 20
    description: Plazo en días hábiles

  - name: fecha_vencimiento
    type: Date
    nullable: false
    description: Fecha límite de respuesta

  - name: prorrogado
    type: Boolean
    default: false
    description: ¿Plazo prorrogado?

  - name: fecha_respuesta
    type: Date
    nullable: true
    description: Fecha de respuesta efectiva

  # Derivación
  - name: area_responsable
    type: String
    nullable: true
    description: División/Unidad responsable

  - name: funcionario_responsable_id
    type: String
    fk: ENT-BACK-FUNCIONARIO
    nullable: true
    description: Funcionario que responde

  # Resultado
  - name: estado
    type: Enum[Ingresada, Derivada, EnElaboracion, Respondida, Prorrogada, Vencida, Amparo]
    default: Ingresada
    description: Estado de la solicitud

  - name: resultado
    type: Enum[Pendiente, EntregaTotal, EntregaParcial, Denegada, Incompetencia, SinInfo]
    default: Pendiente
    description: Resultado de la respuesta

  - name: resolucion_id
    type: String
    fk: ENT-NORM-ACTO
    nullable: true
    description: Resolución de respuesta (si aplica)

  # Amparo CPLT
  - name: amparo_cplt
    type: Boolean
    default: false
    description: ¿Tiene amparo CPLT?

  - name: amparo_id
    type: String
    nullable: true
    description: ID del amparo si aplica

invariants:
  - id: INV-SAI-001
    name: respondida_requiere_fecha
    rule: |
      estado = 'Respondida' → fecha_respuesta IS NOT NULL
    description: SAI respondida requiere fecha
    severity: error

lifecycle:
  states:
    - name: Ingresada
      description: Recibida en OIRS
    - name: Derivada
      description: Enviada a área responsable
    - name: EnElaboracion
      description: Preparando respuesta
    - name: Respondida
      description: Respuesta entregada
    - name: Prorrogada
      description: Plazo extendido
    - name: Vencida
      description: Sin respuesta en plazo
    - name: Amparo
      description: Con amparo CPLT

morphisms:
  resuelta_por: [ENT-NORM-ACTO]
  asignada_a: [ENT-BACK-FUNCIONARIO]

audit:
  fields_tracked:
    - estado
    - resultado
  retention_years: 6
