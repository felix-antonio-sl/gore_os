_meta:
  urn: urn:goreos:entity:unknown:unknown:1.0.0
  type: Entity
  schema: urn:goreos:schema:entity:1.0.0
category: Master
is_abstract: false
attributes:
- name: id_plan
  type: String
  key: true
  description: 'Identificador único (ej: PA-INT2025001-V1)'
- name: intervencion_id
  type: String
  fk: ENT-FENIX-INTERVENCION
  nullable: false
  description: Intervención a la que pertenece
- name: version
  type: Integer
  default: 1
  description: Versión del plan (1, 2, 3...)
- name: nombre
  type: String
  nullable: false
  description: Nombre descriptivo del plan
- name: estrategia
  type: Text
  nullable: false
  description: Descripción de la estrategia general
- name: enfoque
  type: Enum[Correctivo, Preventivo, Aceleracion, Estabilizacion, Contencion]
  nullable: false
  description: Tipo de enfoque estratégico
- name: hipotesis
  type: Text
  nullable: true
  description: Hipótesis de trabajo del plan
- name: hitos_clave
  type: JSON
  nullable: false
  description: "Hitos del plan:\n[{\n  \"orden\": 1,\n  \"descripcion\": \"...\",\n\
    \  \"fecha_objetivo\": \"...\",\n  \"responsable_id\": \"...\",\n  \"completado\"\
    : false\n}]\n"
- name: hitos_completados
  type: Integer
  default: 0
- name: hitos_totales
  type: Integer
  default: 0
- name: kpis_especificos
  type: JSON
  nullable: true
  description: "KPIs del plan:\n[{\n  \"indicador\": \"...\",\n  \"meta\": 0,\n  \"\
    actual\": 0,\n  \"peso\": 0.25\n}]\n"
- name: fecha_inicio
  type: Date
  nullable: false
- name: fecha_fin_planificada
  type: Date
  nullable: false
- name: fecha_revision
  type: Date
  nullable: true
  description: Próxima fecha de revisión del plan
- name: fecha_cierre
  type: Date
  nullable: true
- name: estado
  type: Enum[Borrador, Activo, EnRevision, Superado, Exitoso, Fallido]
  default: Borrador
  description: Estado del plan
- name: es_plan_vigente
  type: Boolean
  default: true
  description: ¿Es el plan actualmente vigente?
- name: aprobador_id
  type: String
  fk: ENT-BACK-FUNCIONARIO
  nullable: true
- name: fecha_aprobacion
  type: Date
  nullable: true
- name: motivo_superacion
  type: Text
  nullable: true
  description: Por qué se pasó a un nuevo plan
- name: observaciones
  type: Text
  nullable: true
invariants:
- id: INV-PA-001
  name: un_plan_vigente_por_intervencion
  rule: 'COUNT(WHERE intervencion_id = X AND es_plan_vigente = TRUE) <= 1

    '
  description: Solo un plan vigente por intervención
  severity: error
- id: INV-PA-002
  name: activo_requiere_aprobacion
  rule: estado = 'Activo' → fecha_aprobacion IS NOT NULL
  description: Plan activo debe estar aprobado
