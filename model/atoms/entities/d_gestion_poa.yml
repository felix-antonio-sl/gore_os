_meta:
  urn: urn:goreos:entity:d_gestion:ENT-GESTION-POA:1.0.0
  type: Entity
  schema: urn:goreos:schema:entity:1.0.0
category: Master
is_abstract: false
attributes:
- name: id_poa
  type: String
  key: true
  description: 'Identificador único (ej: POA-DAF-2025)'
- name: division_id
  type: String
  fk: ENT-BACK-DIVISION
  nullable: false
  description: División responsable del POA
- name: periodo_fiscal
  type: Integer
  nullable: false
  description: Año fiscal del POA
- name: erd_vigente_id
  type: String
  fk: ENT-PLAN-ERD
  nullable: false
  description: ERD que orienta el POA
- name: eje_estrategico_id
  type: String
  fk: ENT-PLAN-EJE
  nullable: true
  description: Eje ERD prioritario para la división
- name: fecha_elaboracion
  type: Date
  nullable: true
  description: Fecha de elaboración inicial
- name: elaborador_id
  type: String
  fk: ENT-BACK-FUNCIONARIO
  nullable: true
  description: Funcionario que elaboró el POA
- name: fecha_aprobacion_jefe
  type: Date
  nullable: true
  description: Aprobación del Jefe de División
- name: fecha_aprobacion_ar
  type: Date
  nullable: true
  description: Aprobación del Administrador Regional
- name: fecha_aprobacion_gr
  type: Date
  nullable: true
  description: Aprobación del Gobernador Regional
- name: estado
  type: Enum[Borrador, EnRevision, AprobadoJefe, AprobadoAR, AprobadoGR, EnEjecucion,
    CierreParcial, Cerrado]
  default: Borrador
  description: Estado del ciclo del POA
- name: objetivos_totales
  type: Integer
  default: 0
  description: Número de objetivos definidos
- name: metas_totales
  type: Integer
  default: 0
  description: Número de metas asociadas
- name: metas_cumplidas
  type: Integer
  default: 0
  description: Metas con cumplimiento ≥90%
- name: metas_en_riesgo
  type: Integer
  default: 0
  description: Metas con cumplimiento <50%
- name: avance_porcentual
  type: Decimal
  computed: true
  formula: "CASE \n  WHEN metas_totales = 0 THEN 0\n  ELSE (metas_cumplidas / metas_totales)\
    \ * 100\nEND\n"
  description: Porcentaje global de cumplimiento
- name: presupuesto_vinculado
  type: Decimal
  default: 0
  description: Monto presupuestario asociado en M$
- name: cdps_asociados
  type: Array[String]
  nullable: true
  description: IDs de CDPs vinculados a metas
- name: observaciones_ar
  type: Text
  nullable: true
  description: Observaciones del AR en revisión
- name: observaciones_gr
  type: Text
  nullable: true
  description: Observaciones del Gobernador
invariants:
- id: INV-POA-001
  name: aprobacion_secuencial
  rule: 'fecha_aprobacion_ar IS NOT NULL → fecha_aprobacion_jefe IS NOT NULL

    '
  description: AR aprueba después del Jefe de División
  severity: error
- id: INV-POA-002
  name: gr_aprueba_post_ar
  rule: 'fecha_aprobacion_gr IS NOT NULL → fecha_aprobacion_ar IS NOT NULL

    '
  description: GR aprueba después del AR
  severity: error
- id: INV-POA-003
  name: ejecucion_requiere_aprobacion_gr
  rule: 'estado = ''EnEjecucion'' → fecha_aprobacion_gr IS NOT NULL

    '
  description: Solo POA aprobado por GR entra en ejecución
- id: INV-POA-004
  name: plazo_aprobacion
  rule: "fecha_aprobacion_gr <= MAKE_DATE(periodo_fiscal, 1, 31) OR \nestado IN ('Borrador',\
    \ 'EnRevision')\n"
  description: POA debe aprobarse antes del 31 de enero
  severity: warning
id: ENT-GESTION-POA
urn: urn:goreos:entity:d_gestion:ENT-GESTION-POA:1.0.0
name: Poa
domain: D-GESTION
