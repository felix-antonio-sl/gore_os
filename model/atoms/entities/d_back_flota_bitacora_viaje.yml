_meta:
  urn: urn:goreos:entity:d-back:bitacora-viaje:1.0.0
  type: Entity
  schema: urn:goreos:schema:entity:1.0.0
id: ENT-BACK-BITACORA_VIAJE
urn: urn:goreos:entity:d-back:bitacora-viaje:1.0.0
name: BitÃ¡cora de Viaje
domain: D-BACK
subdomain: flota
category: Operational
is_abstract: false
attributes:
- name: id_bitacora
  type: String
  key: true
- name: vehiculo_id
  type: String
  fk: ENT-BACK-VEHICULO
  nullable: false
- name: fecha_salida
  type: DateTime
  nullable: false
- name: fecha_retorno
  type: DateTime
  nullable: true
- name: km_salida
  type: Integer
  nullable: false
- name: km_retorno
  type: Integer
  nullable: true
- name: km_recorridos
  type: Integer
  computed: true
  formula: km_retorno - km_salida
- name: destino
  type: String
  nullable: false
- name: comuna_destino
  type: String
  nullable: true
- name: motivo
  type: Text
  nullable: false
- name: referencia_cometido
  type: String
  nullable: true
  description: ID del cometido funcionario asociado
- name: conductor_id
  type: String
  fk: ROL-FUNCIONARIO
  nullable: false
- name: conductor_nombre
  type: String
  nullable: false
- name: licencia_clase
  type: String
  nullable: true
- name: pasajeros
  type: List[String]
  nullable: true
- name: cantidad_pasajeros
  type: Integer
  default: 0
- name: carga_combustible
  type: Boolean
  default: false
- name: litros_cargados
  type: Decimal
  nullable: true
- name: vale_combustible
  type: String
  nullable: true
- name: estacion_servicio
  type: String
  nullable: true
- name: estado
  type: Enum[EnCurso, Completado, Incidente]
  default: EnCurso
- name: observaciones
  type: Text
  nullable: true
- name: autorizado_por_id
  type: String
  fk: ROL-JEFE-UNIDAD
  nullable: true
- name: fecha_autorizacion
  type: DateTime
  nullable: true
invariants:
- name: km_coherente
  rule: IF km_retorno NOT NULL THEN km_retorno >= km_salida
- name: horario_laboral
  rule: fecha_salida.hora BETWEEN 08:00 AND 18:00 OR es_fin_semana_autorizado
  source: DL 799
- name: combustible_documentado
  rule: IF carga_combustible THEN vale_combustible NOT NULL
