# Entidad: PPR (Programa Público Regional)
# Domain: D-FIN
# Subdomain: ipr_core
# Generated: 2025-12-21 (Phase 20.1a Core IPR)

id: ENT-FIN-PPR
urn: "urn:goreos:entity:d-fin:ppr:1.0.0"
name: Programa Público Regional
domain: D-FIN
subdomain: ipr_core
category: Master
extends: ENT-FIN-IPR
canonical_source:
  - "sub_dfin_ipr_core.md"
  - "sub_dfin_mecanismos.md"
  - "Glosa 06 Presupuesto"

description: |
  Intervención de gasto corriente/mixto (Subtítulo 24).
  Modalidades: Ejecución directa GORE (Glosa 06) o Transferencia a entidad pública.
  Requiere RF de DIPRES/SES (ejecución directa) o ITF interno (transferencia).

inherits_from: ENT-FIN-IPR

attributes:
  # Hereda todos los atributos de IPR más:

  - name: modalidad_ejecucion
    type: Enum[EjecucionDirecta, Transferencia]
    nullable: false

  - name: mecanismo_ppr
    type: Enum[G06, TRANSF, S8, FRPD_PPR]
    nullable: false

  # Marco Lógico
  - name: objetivo_general
    type: Text
    nullable: false

  - name: objetivo_especifico
    type: Text
    nullable: true

  - name: mml_definido
    type: Boolean
    default: false
    description: Marco Metodológico-Lógico aprobado

  - name: mml_documento_url
    type: String
    nullable: true

  # Glosa 06 específico
  - name: es_glosa_06
    type: Boolean
    computed: true
    formula: mecanismo_ppr = G06

  - name: unidad_ejecutora_gore
    type: String
    nullable: true
    description: División/Departamento GORE que ejecuta

  # Transferencia específico
  - name: es_transferencia
    type: Boolean
    computed: true
    formula: mecanismo_ppr IN (TRANSF, S8)

  - name: entidad_receptora
    type: String
    nullable: true

  - name: tipo_entidad_receptora
    type: Enum[Municipio, Servicio, Universidad, ONG, Fundacion]
    nullable: true

  # Subvención 8% específico
  - name: es_subvencion_8
    type: Boolean
    computed: true
    formula: mecanismo_ppr = S8

  - name: porcentaje_fndr
    type: Decimal
    nullable: true
    description: Porcentaje del FNDR asignado

  # Evaluación
  - name: rate_tipo
    type: Enum[RF, ITF, FI, OT]
    nullable: true

  - name: evaluador
    type: Enum[DIPRES_SES, GORE_DAF, GORE_DIPIR]
    nullable: true

  # Indicadores
  - name: beneficiarios_meta
    type: Integer
    nullable: true

  - name: beneficiarios_reales
    type: Integer
    nullable: true

  - name: productos_meta
    type: Text
    nullable: true

  - name: productos_logrados
    type: Text
    nullable: true

invariants:
  - name: mml_requerido_g06
    rule: "IF es_glosa_06 AND estado = AprobadoCORE THEN mml_definido = true"
    source: "sub_dfin_mecanismos.md - Antipatrones"

  - name: entidad_receptora_requerida
    rule: "IF es_transferencia THEN entidad_receptora NOT NULL"

  - name: gastos_admin_tope
    rule: "Gastos administrativos <= 5% del total"
    source: "Glosa 06"

morphisms:
  es_un: [ENT-FIN-IPR]
  evaluado_por: [DIPRES_SES, GORE]
  genera: [ENT-FIN-TRANSFERENCIA, ENT-FIN-RENDICION]
  ejecutado_por: [GORE_Directo, EntidadReceptora]
