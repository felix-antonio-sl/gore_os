_meta:
  urn: urn:goreos:entity:unknown:unknown:1.0.0
  type: Entity
  schema: urn:goreos:schema:entity:1.0.0
category: Master
is_abstract: false
attributes:
- name: id_hito
  type: String
  key: true
  description: Identificador único
- name: convenio_id
  type: String
  fk: ENT-PLAN-CP
  nullable: false
  description: Convenio al que pertenece
- name: ipr_vinculada_id
  type: String
  fk: ENT-FIN-IPR
  nullable: true
  description: IPR específica si el hito es un proyecto
- name: descripcion
  type: String
  nullable: false
  description: Descripción del hito
- name: tipo
  type: Enum[Financiero, Entregable, Administrativo, Cierre]
  default: Financiero
  description: Tipo de hito
- name: fecha_comprometida
  type: Date
  nullable: false
  description: Fecha acordada para el hito
- name: fecha_real_cumplimiento
  type: Date
  nullable: true
  description: Fecha real de cumplimiento
- name: dias_atraso
  type: Integer
  computed: true
  formula: "IF(fecha_real_cumplimiento IS NOT NULL, \n   DATEDIFF(fecha_real_cumplimiento,\
    \ fecha_comprometida),\n   IF(CURRENT_DATE > fecha_comprometida, \n      DATEDIFF(CURRENT_DATE,\
    \ fecha_comprometida), 0))\n"
  description: Días de atraso (positivo = atrasado)
- name: monto_asociado
  type: Decimal
  nullable: true
  description: Monto del hito en M$
- name: aporte_gore
  type: Decimal
  nullable: true
  description: Porción GORE del monto
- name: aporte_sectorial
  type: Decimal
  nullable: true
  description: Porción sectorial del monto
- name: estado
  type: Enum[Pendiente, EnProceso, Cumplido, Atrasado, Cancelado]
  default: Pendiente
  description: Estado del hito
- name: observaciones
  type: Text
  nullable: true
  description: Notas de seguimiento
- name: evidencia_url
  type: String
  nullable: true
  description: URL de documento de respaldo
invariants:
- id: INV-HITO-001
  name: atrasado_automatico
  rule: '(CURRENT_DATE > fecha_comprometida AND estado = ''Pendiente'') → estado =
    ''Atrasado''

    '
  description: Hito pendiente posterior a fecha se marca atrasado
  severity: warning
- id: INV-HITO-002
  name: cumplido_requiere_fecha
  rule: '(estado = ''Cumplido'') → (fecha_real_cumplimiento IS NOT NULL)

    '
  description: Hito cumplido debe tener fecha real
