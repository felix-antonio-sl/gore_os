# ==============================================================================
# GORE_OS Entity Atom: Permiso
# ==============================================================================
# Domain: D-OPS (Operaciones del Sistema)
# Subdomain: Gestión IAM (M1)
# ==============================================================================

_metadata:
  version: "1.0.0"
  status: active
  created_at: "2025-12-22"
  created_by: "Ingeniero Software Composicional"
  domain: D-OPS
  subdomain: gestion_iam

entity:
  id: ENT-OPS-PERMISO
  name: Permiso
  name_es: Permiso
  description: |
    Capacidad atómica de realizar una acción sobre un recurso.
    Formato: recurso:accion (ej: proyecto:crear, reporte:ver)

  purpose: |
    Modelar permisos para:
    - Granularidad de control de acceso
    - Principio de mínimo privilegio
    - Auditoría de capacidades

  categorical_type: Object
  is_abstract: false
  category: Authorization

attributes:
  - name: id_permiso
    type: String
    key: true

  - name: codigo
    type: String
    nullable: false
    description: "Código único ej: proyecto:crear, usuario:eliminar"

  - name: recurso
    type: String
    nullable: false
    description: "Tipo de recurso (proyecto, usuario, reporte, etc.)"

  - name: accion
    type: Enum[Crear, Ver, Editar, Eliminar, Exportar, Aprobar, Administrar]
    nullable: false

  - name: descripcion
    type: String
    nullable: true

  - name: dominio
    type: String
    nullable: true
    description: "Dominio GORE_OS (D-FIN, D-PLAN, etc.)"

  - name: nivel_riesgo
    type: Enum[Bajo, Medio, Alto, Critico]
    default: Medio
    description: "Para auditoría de permisos sensibles"

  - name: requiere_mfa
    type: Boolean
    default: false
    description: "Si requiere autenticación de dos factores"

invariants:
  - id: INV-PERM-001
    name: codigo_unico
    rule: UNIQUE(codigo)
    description: "Código de permiso debe ser único"

  - id: INV-PERM-002
    name: critico_requiere_mfa
    rule: nivel_riesgo = 'Critico' → requiere_mfa = true
    description: "Permisos críticos requieren MFA"

morphisms:
  asignado_a_rol: [ENT-OPS-ROL]

audit:
  fields_tracked: []
  retention_years: 10
