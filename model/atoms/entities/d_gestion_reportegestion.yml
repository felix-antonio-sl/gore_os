_meta:
  urn: urn:goreos:entity:unknown:unknown:1.0.0
  type: Entity
  schema: urn:goreos:schema:entity:1.0.0
category: Master
is_abstract: false
attributes:
- name: id_reporte
  type: String
  key: true
  description: 'Identificador único (ej: REP-2025-T1)'
- name: tipo
  type: Enum[Mensual, Trimestral, Anual, Extraordinario]
  nullable: false
  description: Tipo de reporte
- name: periodo
  type: String
  nullable: false
  description: 'Período cubierto (ej: 2025-T1, 2025-03)'
- name: año_fiscal
  type: Integer
  nullable: false
  description: Año fiscal
- name: trimestre
  type: Integer
  nullable: true
  description: Trimestre (1-4) si aplica
- name: mes
  type: Integer
  nullable: true
  description: Mes (1-12) si aplica
- name: resumen_ejecutivo
  type: Text
  nullable: true
  description: Síntesis para Gobernador
- name: contenido
  type: JSON
  nullable: false
  description: "Estructura del reporte:\n{\n  \"poas\": [{poa_id, avance_pct, metas_cumplidas}],\n\
    \  \"hgore\": {valor, tendencia, alertas},\n  \"riesgos_criticos\": [{id, estado}],\n\
    \  \"playbooks_ejecutados\": [{id, resultado}],\n  \"mejoras\": [{id, estado}]\n\
    }\n"
- name: hgore_promedio
  type: Decimal
  nullable: true
  description: H_gore promedio del período
- name: hgore_tendencia
  type: Enum[Mejorando, Estable, Degradando]
  nullable: true
  description: Tendencia del período
- name: poa_avance_global
  type: Decimal
  nullable: true
  description: Avance promedio de POAs
- name: ejecucion_presupuestaria
  type: Decimal
  nullable: true
  description: Porcentaje de ejecución presupuestaria
- name: convenios_vigentes
  type: Integer
  nullable: true
  description: Número de convenios vigentes
- name: fecha_generacion
  type: Date
  nullable: false
  description: Fecha de generación
- name: generado_por_id
  type: String
  fk: ENT-BACK-FUNCIONARIO
  nullable: true
  description: Quien generó el reporte
- name: generacion_automatica
  type: Boolean
  default: false
  description: ¿Generado automáticamente?
- name: aprobador_id
  type: String
  fk: ENT-BACK-FUNCIONARIO
  nullable: true
  description: Quien aprobó (AR o GR)
- name: fecha_aprobacion
  type: Date
  nullable: true
  description: Fecha de aprobación
- name: estado
  type: Enum[Borrador, EnRevision, Aprobado, Publicado]
  default: Borrador
  description: Estado del reporte
- name: destinatarios
  type: Array[String]
  nullable: true
  description: Roles o personas que reciben
- name: url_documento
  type: String
  nullable: true
  description: URL del documento final (PDF)
invariants:
- id: INV-REP-001
  name: publicado_requiere_aprobacion
  rule: estado = 'Publicado' → fecha_aprobacion IS NOT NULL
  description: Reporte publicado debe estar aprobado
  severity: error
- id: INV-REP-002
  name: trimestral_requiere_hgore
  rule: tipo = 'Trimestral' → hgore_promedio IS NOT NULL
  description: Reporte trimestral debe incluir H_gore
  severity: warning
