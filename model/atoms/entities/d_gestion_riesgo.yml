_meta:
  urn: urn:goreos:entity:unknown:unknown:1.0.0
  type: Entity
  schema: urn:goreos:schema:entity:1.0.0
category: Master
is_abstract: false
attributes:
- name: id_riesgo
  type: String
  key: true
  description: 'Identificador único (ej: RSG-2025-001)'
- name: codigo
  type: String
  nullable: false
  description: 'Código corto (ej: RSG-FIN-001)'
- name: nombre
  type: String
  nullable: false
  description: Nombre descriptivo del riesgo
- name: descripcion
  type: Text
  nullable: false
  description: Descripción detallada del riesgo
- name: categoria
  type: Enum[Politico, Financiero, Operacional, Probidad, Reputacional, Tecnologico,
    Legal]
  nullable: false
  description: Categoría del riesgo
- name: subcategoria
  type: String
  nullable: true
  description: Subcategoría específica
- name: proceso_afectado
  type: String
  nullable: true
  description: Proceso o área afectada
- name: division_id
  type: String
  fk: ENT-BACK-DIVISION
  nullable: true
  description: División más afectada
- name: objetivo_poa_afectado_id
  type: String
  fk: ENT-GESTION-INDICADOR-POA
  nullable: true
  description: Objetivo POA que impacta
- name: probabilidad
  type: Enum[MuyBaja, Baja, Media, Alta, MuyAlta]
  nullable: false
  description: Probabilidad de ocurrencia
- name: impacto
  type: Enum[Insignificante, Menor, Moderado, Mayor, Catastrofico]
  nullable: false
  description: Impacto si se materializa
- name: nivel_riesgo_inherente
  type: Integer
  computed: true
  formula: probabilidad_num * impacto_num
  description: Riesgo sin controles (1-25)
- name: nivel_riesgo_residual
  type: Integer
  nullable: true
  description: Riesgo con controles aplicados
- name: prioridad
  type: Enum[Critica, Alta, Media, Baja]
  computed: true
  formula: "CASE \n  WHEN nivel_riesgo_inherente >= 20 THEN 'Critica'\n  WHEN nivel_riesgo_inherente\
    \ >= 12 THEN 'Alta'\n  WHEN nivel_riesgo_inherente >= 6 THEN 'Media'\n  ELSE 'Baja'\n\
    END\n"
- name: estrategia_tratamiento
  type: Enum[Evitar, Mitigar, Transferir, Aceptar]
  nullable: true
  description: Estrategia de respuesta
- name: responsable_id
  type: String
  fk: ENT-BACK-FUNCIONARIO
  nullable: false
  description: Dueño del riesgo
- name: supervisor_id
  type: String
  fk: ENT-BACK-FUNCIONARIO
  nullable: true
  description: Supervisor UC
- name: fecha_identificacion
  type: Date
  nullable: false
  description: Fecha de identificación
- name: fecha_ultima_evaluacion
  type: Date
  nullable: true
  description: Última evaluación del riesgo
- name: fecha_proxima_revision
  type: Date
  nullable: true
  description: Próxima revisión programada
- name: estado
  type: Enum[Activo, Mitigado, Materializado, Cerrado, Transferido]
  default: Activo
  description: Estado actual del riesgo
- name: fecha_materializacion
  type: Date
  nullable: true
  description: Fecha si se materializó
- name: impacto_real
  type: Text
  nullable: true
  description: Descripción del impacto real
- name: reportado_cgr
  type: Boolean
  default: false
  description: ¿Reportado a CGR?
- name: observaciones_cgr
  type: Text
  nullable: true
  description: Observaciones de la CGR
invariants:
- id: INV-RSG-001
  name: materializado_requiere_fecha
  rule: estado = 'Materializado' → fecha_materializacion IS NOT NULL
  description: Riesgo materializado debe tener fecha
  severity: error
- id: INV-RSG-002
  name: critico_requiere_controles
  rule: "prioridad = 'Critica' → \nEXISTS (SELECT 1 FROM Control c WHERE c.riesgo_id\
    \ = id_riesgo)\n"
  description: Riesgo crítico debe tener al menos un control
  severity: warning
