_meta:
  urn: urn:goreos:entity:unknown:unknown:1.0.0
  type: Entity
  schema: urn:goreos:schema:entity:1.0.0
category: Master
is_abstract: false
attributes:
- name: id_riesgo
  type: String
  key: true
- name: nombre
  type: String
  nullable: false
  description: 'Resumen del escenario (ej: Fuga de datos por malware)'
- name: descripcion
  type: Text
  nullable: true
- name: activo_afectado_id
  type: String
  fk: ENT-SEG-ACTIVO-INFORMACION
  nullable: false
  description: Activo principal en riesgo
- name: amenaza_id
  type: String
  nullable: false
  description: 'ID de Amenaza (ej: AME-001 Ransomware)'
- name: vulnerabilidad_id
  type: String
  nullable: true
  description: ID de Vulnerabilidad explotada
- name: probabilidad_inherente
  type: Integer
  nullable: false
  description: 1-5 (Muy Baja a Muy Alta)
- name: impacto_inherente
  type: Integer
  nullable: false
  description: 1-5 (Insignificante a Catastrófico)
- name: nivel_riesgo_inherente
  type: Integer
  computed: true
  formula: probabilidad_inherente * impacto_inherente
  description: 1-25
- name: controles_existentes_ids
  type: Array[String]
  nullable: true
  description: Controles ya implementados
- name: probabilidad_residual
  type: Integer
  nullable: false
- name: impacto_residual
  type: Integer
  nullable: false
- name: nivel_riesgo_residual
  type: Integer
  computed: true
  formula: probabilidad_residual * impacto_residual
  description: 1-25
- name: opcion_tratamiento
  type: Enum[Mitigar, Aceptar, Transferir, Evitar]
  default: Mitigar
- name: justificacion_tratamiento
  type: Text
  nullable: true
- name: plan_tratamiento_id
  type: String
  nullable: true
- name: riesgo_institucional_id
  type: String
  fk: ENT-GESTION-RIESGO
  nullable: true
  description: Link a Riesgo Institucional (D-GESTION) si escala
- name: estado
  type: Enum[Identificado, Analizado, EnTratamiento, Monitoreado, Cerrado]
  default: Identificado
- name: fecha_revision
  type: Date
  nullable: false
invariants:
- id: INV-SEG-RSG-001
  name: residual_menor_inherente
  rule: nivel_riesgo_residual <= nivel_riesgo_inherente
  description: El riesgo residual no debería ser mayor al inherente (salvo error)
